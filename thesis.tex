\input{misc/headers}

% Metadaten
\title{Master thesis research}

\begin{document}
	\begin{titlepage}
		\begin{figure}[ht]
			\minipage{0.5\textwidth}
			\includegraphics[width=6cm,trim=1 1.2 1 1.2,clip]{scicomp-logo-tu.png}
			\label{fig:scicomplogo}
			\endminipage
			\minipage{0.5\textwidth}
			\hfill
			\includegraphics[width=6cm,trim=1 1.2 1 1.2,clip]{TU_kaiserslautern.svg.png}
			\label{fig:tukllogo}
			\endminipage
		\end{figure}		
		\vspace{2cm}
		
		\noindent\textbf{\huge Flow Control \\via Reduced Order Models}\\
		\textbf{\large POD-Galerkin Modeling and Control \\Application for Compressible Flows}\\
		\vspace{1cm}\\
		\textbf{Master's Thesis\\by Jan Rottmayer\\}\linebreak	
		\emph{A thesis submitted in fulfillment of the requirements for the degree\\ Master of Science Maschinenbau mit angewandter Informatik}\\
		\vspace{1em}\\
		\textbf{\large at Chair of Scientific Computing (SciComp)}\\
		\textbf{\large Department of Computer Science}\\				
		\vspace{1cm}\\
		\textbf{1st Reviewer: 		\tab{\;\;Prof. Dr.-Ing. Martin B\"ohle }}\\
		\textbf{2nd Reviewer: 		\tab{\;Prof. Dr. Nicolas R. Gauger}}\\	
		\textbf{1st Supervisor: 	\tab{Dr. Emre \"Ozkaya}}\\
		\textbf{2nd Supervisor: 	\tab{\!\!Max Aehle}}\\
		\vfill
		\noindent
		TU Kaiserslautern\\
		\today
		
	\end{titlepage}
	
	
	
	
	\chapter{Introduction}
		\section{Motivation}
		\section{Problem}
		\section{Task}

	\chapter{Methodology}
		\section{Navier Stokes Equation}
			The derivation of Navier Stokes equations follows \cite{bing_han_2019}.
			\subsection{Reynolds Transport Theorem}
				\begin{figure}[h!]
					\centering
					\includegraphics[width=0.5\linewidth]{ReynoldsTransportTheorem}
					\caption{Material and control volume moving over time.\cite{bing_han_2019}}
					\label{fig:rtt}
				\end{figure}
				Reynolds transport theorem (RTT) provides the conversion formulation between the Lagrangian fluid and the Eulerian fluid description. 
				\begin{equation*}
					\frac{D}{Dt} \int_{MV(t)} F(\vec{r},t)\;d\Omega = \frac{d}{dt} \int_{CV(t)} F(\vec{r},t)\;d\Omega +  \oint_{CS(t)} F(\vec{r},t)\vec{V} \cdot \vec{n}\;dS
				\end{equation*}
				where the material derivative is defined as operator 
				\begin{equation*}
					\frac{D}{Dt} \defgr \frac{\partial}{\partial t} + \vec{V} \cdot \nabla
				\end{equation*}
				with subscript $MV$ indicating material volume, $CV$ indicating control volume, $CS$ indication control surface, $\vec{V}$ being the velocity vector and $\Omega$ being the fluid volume. Applying the divergence theorem
				\begin{equation}
					\int \vec{A}\cdot \vec{n} \; dS = \int \nabla \cdot \vec{A} \; d\Omega
					\label{eq:divtheorem}
				\end{equation} 
				the surface integrals are converted into volume integrals. This yields
				\begin{equation*}
					\frac{D}{Dt} \int_{MV} F\;d\Omega = \frac{d}{dt} \int_{CV} F\;d\Omega +  \int_{CV}\nabla \cdot  (F\vec{V}) \;d\Omega
				\end{equation*}
				Let $F = \rho \phi$, then 
				\begin{equation}
					\frac{D}{Dt} \int_{MV} \rho \phi\;d\Omega = \frac{d}{dt} \int_{CV} \rho \phi\;d\Omega +  \int_{CV}\nabla \cdot  (\rho \phi \vec{V}) \;d\Omega
					\label{eq:rttvolume}
				\end{equation}
				Given a control volume in form and volume arbitrary but fixed in time the additional constraint 
				\begin{equation}
					\frac{d}{dt} \int_{CV} F\;d\Omega = \int_{CV} \frac{\partial F}{\partial t} \;d\Omega
					\label{eq:rttcontraint}
				\end{equation}
				is necessary. Taking constraint \ref{eq:rttcontraint} into equation \ref{eq:rttvolume} it yields:
				\begin{equation*}
					\frac{D}{Dt} \int_{MV} F\;d\Omega = \int_{CV} [\frac{\partial F}{\partial t} + \nabla \cdot (F \vec{V})] d\Omega
				\end{equation*}
				Due to 
				\begin{equation*}
					\nabla \cdot (F\vec{V}) = \vec{V} \cdot \nabla F + F \nabla \cdot \vec{V}
				\end{equation*}
				s.t.
				\begin{equation*}
						\frac{\partial F}{\partial t} + \nabla \cdot (F\vec{V}) = (\frac{\partial F}{\partial t} + \vec{V} \cdot \nabla F) + F \nabla \cdot \vec{V} = \frac{D F}{Dt} + F \nabla \cdot \vec{V}
				\end{equation*}
				and finally the Reynolds transport theorem within the fixed control volume is derived
				\begin{align*}
					\frac{D}{Dt} \int_{MV} F\;d\Omega &= \int_{CV} \frac{D F}{D t} \;d\Omega + \int_{CV} F \nabla \cdot \vec{V} \; d\Omega \\
					\frac{D}{Dt} \int_{MV} \rho \phi\;d\Omega &= \int_{CV} \frac{D (\rho \phi)}{D t} \;d\Omega + \int_{CV} \rho \phi \nabla \cdot \vec{V} \; d\Omega 
				\end{align*}
			\subsection{Conservation of Mass}
				Let $\phi=1$, the mass $m$ can be represented as 
				\begin{equation*}
					m = \int_{MV} \rho \; d\Omega.
				\end{equation*}
				The Lagrangian description yields the equation for conservation of mass as
				\begin{equation*}
					\frac{D m}{D t} = \frac{D}{D t} \int_{MV} \rho \; d\Omega = 0.
				\end{equation*}
				For the constraint of arbitrary but fixed control volume the conservation of mass writes
				\begin{align*}
					\frac{D}{D t} \int_{MV} \rho \; d\Omega &= \frac{d}{d t} \int_{CV} \rho \;d\Omega + \int_{CV} \nabla \cdot (\rho\vec{V})\;d\Omega\\
					&= \int_{CV}[ \frac{\partial \rho}{\partial t} + \nabla \cdot (\rho\vec{V})]\;d\Omega = 0
				\end{align*} 
				Finally the differential form of the continuity equation in the Eulerian description writes:
				\begin{align*}
					\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho\vec{V}) &= \frac{\partial \rho}{\partial t} + \rho (\nabla \cdot \vec{V}) + \vec{V} \cdot (\nabla \rho) = 0 \\
					\nabla \cdot (\rho\vec{V}) &= \rho (\nabla \cdot \vec{V}) + \vec{V} \cdot (\nabla \rho) = 0
				\end{align*}  
			\subsection{Conservation of Momentum}
				Let $\phi = \vec{V}$, the momentum $\vec{M}$ is given as 
				\begin{equation*}
					\vec{M} = \int_{MV} \rho \vec{V} \; d\Omega
				\end{equation*}
				The conservation of momentum in the Lagrangian description writes
				\begin{equation}
					\underbrace{\frac{D}{D t} \int_{MV} \vec{V} \rho \; d\Omega}_{\text{Rate of change of momentum}} = \underbrace{\int_{MV} \vec{f} \rho \; d\Omega}_{\text{Body force}} + \underbrace{\int_{MS} \bar{T} \cdot \vec{n} \; dS}_{\text{Surface force}}
					\label{eq:consmass}
				\end{equation}
				where $\bar{T}$ is the stress tensor and $\vec{f}$ is the body force. Applying Reynolds transport theorem to \ref{eq:consmass} the equation yields
				\begin{equation*}
					\frac{d}{d t} \int_{CV} \vec{V} \rho \; d\Omega + \int_{CS} \vec{V} \rho \vec{V} \cdot \vec{n} \; dS = \int_{CV} \vec{f} \rho \; d\Omega + \int_{CS} \bar{T} \cdot \vec{n} \; dS.
				\end{equation*}
				Utilizing \ref{eq:divtheorem} to transform the surface integrals to volume integrals the equation notes:
				\begin{equation}
					\frac{d}{d t} \int_{CV} \vec{V} \rho \; d\Omega + \int_{CV} \nabla \cdot (\vec{V} \rho \vec{V}) \; d\Omega = \int_{CV} \vec{f} \rho \; d\Omega + \int_{CV} \nabla \cdot \bar{T} \; d\Omega.
					\label{eq:intmom}
				\end{equation}
				For arbitrary, but fixed control volumes equation \ref{eq:intmom} becomes
				\begin{equation*}
					\int_{CV} [ \frac{\partial}{\partial t} (\rho \vec{V}) + \nabla \cdot (\rho \vec{V} \vec{V}) - \rho \vec{f} - \nabla \cdot \bar{T}] \; d\Omega = 0.
				\end{equation*}
				The final differential form of the momentum equation in Eulerian description notes:
				\begin{equation}
					\frac{\partial}{\partial t} (\rho \vec{V}) + \nabla \cdot (\rho \vec{V} \vec{V}) = \rho \vec{f} + \nabla \cdot \bar{T}
					\label{eq:momentum}
				\end{equation}
			
			\subsection{Compressible Navier Stokes}
				The stress tensor $\bar{T}$ can be expressed as sum of the hydrostatic stress tensor and the deviatoric stress tensor. Under the assumptions:
				\begin{itemize}
					\setlength\itemsep{-0.5em}
					\item The stress tensor is a linear function of the strain rates.
					\item The fluid is isotropic.
					\item For a fluid at rest, $\nabla \cdot \bar{T} = 0$ s.t. hydrostatic pressure results. 
				\end{itemize} 
				The stress tensor notes
				\begin{equation*}
					\bar{T} = T_{ij} = -p \delta_{ij} + \tau_{ij}
				\end{equation*}
				The second term for a Newtonian fluid is proportional to the rate of deformation
				\begin{equation*}
					\tau_{ij} = \mu (\frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i}) + \lambda \frac{\partial u_k}{\partial x_k} \delta_{ij},
				\end{equation*} 
				where $\mu$ is the dynamic viscosity. The total stress tensor in vector form states
				\begin{equation}
					\bar{T} = (-p + \lambda \nabla \cdot \vec{V}) \bar{I} + 2 \mu \bar{D},
					\label{eq:newtstressten}
				\end{equation}
				where $\bar{D} = D_{ij} = \frac{1}{2}(\frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i})$. Substituting \ref{eq:newtstressten} into the momentum equation \ref{eq:momentum} yields the momentum equation for Newtonian fluids known as compressible Navier Stokes:
				\begin{equation}
					\frac{\partial}{\partial t} (\rho \vec{V}) + \nabla \cdot (\rho \vec{V} \vec{V}) = \rho \vec{f} - \nabla p + \mu \nabla^2 \vec{V}
					\label{eq:compmomentum}
				\end{equation}
			\subsection{Isentropic Navier Stokes}\label{sec:INS}
				Under the assumptions of a cold flow ($T_{wall} = T_{\infty}$) and moderate mach number, the density gradients remain small and dominated by pressure changes. This is consistent with neglect of the viscous dissipation and heat conduction in the conservation of energy, thus the flow can be treated as reversible or isentropic ($ds = 0$). Additionally constant kinematic and dynamic viscosity is assumed s.t. the equations of motion become
				\begin{align}
					\frac{D \vec{V}}{D t} + \frac{1}{\rho} \nabla p &= \nu \nabla^2 \vec{V} \nonumber\\
					\frac{D \rho}{D t} + \rho (\nabla \cdot \vec{V}) &= 0 \label{eq:isennsass}\\
					ds &= 0 \nonumber
				\end{align}
				where $\nu = \frac{\mu}{\rho}$ and $s$ is the entropy. Utilizing the ideal gas law $p = \rho R T$ and the Gibbs equation $dh = T\; ds + \frac{1}{\rho}\;dp$ the set of equations \ref{eq:isennsass} can be written in terms of the enthalpy $h$ instead of the pressure:
				\begin{align}
					\frac{D \vec{V}}{D t} + \nabla h &= \nu \nabla^2 \vec{V} \label{eq:isennsenth}\\
					\frac{D h}{D t} + (\gamma - 1 )h (\nabla \cdot \vec{V}) &= 0, \nonumber
				\end{align}
				where $\gamma$ is the isentropic coefficient. This procedure can be done with any thermodynamic variable, but the choice of enthalpy is particularly convenient as the resulting equation \ref{eq:isennsenth} is quadratic. Using the ideal gas relation $a^2 = (\gamma - 1)h$ equation \ref{eq:isennsass} becomes:
				\begin{align}
					\frac{D \vec{V}}{D t} + \frac{2}{\gamma - 1}a \nabla a &= \nu \nabla^2 \vec{V} \label{eq:isennsmach}\\
					\frac{D a}{D t} + \frac{\gamma - 1 }{2}a (\nabla \cdot \vec{V}) &= 0 \nonumber
				\end{align}
				Note equation \ref{eq:isennsenth} and \ref{eq:isennsmach} are equivalent and both are referred to as isentropic Navier-Stokes equations.			
			\subsection{Non-dimensionalization} 
				For the non-dimensionalization of flow variables the freestream conditions are used to scale the problem accordingly.\\
				\begin{table}[hbt]
					\centering
					\begin{tabular}{ l l r }
						\hline
						Scaling Parameter & Description & Dimension \\
						\hline
						$L$ & Characteristic length & [$m$] \\
						$V$ & Characteristic velocity & [$\frac{m}{s}$] \\
						$f$ & Characteristic frequency & [$\frac{1}{s}$] \\
						$p_0 - P_{\infty}$ & Reference pressure difference & [$\frac{kg}{m s^2}$] \\
						\hline
					\end{tabular}
					\caption{Scaling parameters with their primary dimensions.}\label{tab:nondim}
				\end{table}
			The non-dimensional variables using the scaling parameters of \ref{tab:nondim} yield:
			\begin{equation*}
			\begin{aligned}[c]
				t^* &= f t \\
				p^* &= \frac{p - p_{\infty}}{p_0 - p_{\infty}}\\
				\vec{V}^* &= \frac{\vec{V}}{V}
			\end{aligned}
			\qquad\qquad
			\begin{aligned}[c]
				\vec{x}^* &= \frac{\vec{x}}{L}\\
				\vec{\nabla}^* &= L \vec{\nabla}
			\end{aligned}
			\label{eq:nondimvar}
			\end{equation*}
			As example for the non-dimensionalization equation \ref{eq:compmomentum} is considered without external forces $f$. Every term in equation \ref{eq:compmomentum} has primary dimensions [$\frac{kg}{m^2 s^2}$], s.t. multiplication by constant $\frac{L}{\rho V^2} = [\frac{m^2 s^2}{kg}]$ cancels the dimension. Additionally substituting \ref{eq:nondimvar} yields the non-dimensionalized compressible Navier Stokes
			\begin{equation}
				[\frac{f L}{V}] \frac{\partial \vec{V}^*}{\partial t^*} + (\vec{V}^* \cdot \vec{\nabla}^*)\vec{V}^* = - [\frac{p_0 -p_{\infty}}{pV^2}]\vec{\nabla}^* p^* + [\frac{\mu}{\rho V L}] \nabla^{*2}\vec{V}^*
				\label{eq:nondimns}
			\end{equation}
			The additional non-dimensional terms correspond to
			\begin{itemize}
				\setlength\itemsep{-0.5em}
				\item Strouhal number $$St = \frac{fL}{V}$$
				\item Euler number $$Eu = \frac{p_0 -p_{\infty}}{pV^2}$$
				\item Inverse Reynolds number $$ \frac{1}{Re} = \frac{\mu}{\rho V L}$$
			\end{itemize}
			Non-dimensionalization is advantageous as for any value of scaling parameters $L,V,\dots$ equation \ref{eq:nondimns} holds. The non-dimensionalization of the isentropic Navier Stokes \ref{eq:isennsmach} can be performed in similar fashion.  
		
		\section{Spatial Discretization}\label{sec:spacediscr}
			\begin{figure}[h!]
				\centering
				\includegraphics[width=0.5\linewidth]{mesh}
				\caption{Rotational symmetric Mesh with a grid constructed of 200 equidistant angular levels and 112 almost logarithmic scaled radii with a central cylinder cutout.}
				\label{fig:mesh}
			\end{figure}
			The fluid domain $\Omega$ is constructed of quadrilateral cells. The cells are arranged in a rotational symmetric pattern around a central cylindrical cutout with radius $R = 0.5$. The cells are arranged such that the nodes coincide on fixed levels with respect to the center. They form a finite potential map in terms of radial coordinate $r$ and angular coordinate $\phi$. The discretization produces $200$ equidistant angular levels and $112$ radius levels that are linearly spaced near the central cylinder and logarithmic spaced towards the outer boundary. \\
			The elementary geometry is depicted in figure \ref{fig:mesh}.
	
		\section{Boundary Conditions}
			The numerical simulation of flow problems require the confinement of a
			conceptually unbounded flow domain to a bounded computational domain,
			thereby introducing artificial boundaries, along which a set of boundary
			conditions can be enforced. \cite{Rannacher2000}	\\
			Most commonly a boundary integral arises when solving the governing partial differential equation by integration by parts. The boundary integral may be fixed to enforce a set of boundary condition. The first-type boundary condition, more well known as Dirichlet condition, enforces fixed values on the system variables along the boundary $\partial \Omega$. The second-type boundary, known as Neumann condition, enforces a fixed normal derivative to the boundary and has shown to be less intrusive to the solution inside the computational domain. \\ 
			Let $\mathbf{q} \in \R^n$ denote the state described by an arbitrary partial differential equation, then the \emph{Dirichlet} boundary yields
			\begin{equation*}
				\mathbf{q}(x) = f(x)\qquad \forall x \in \partial \Omega,
			\end{equation*}
			where $x$ denotes the spatial coordinate and $f(x)$ is a known function defined on the boundary. \\
			Similarly the \emph{Neumann} boundary condition yields
			\begin{equation}
				\frac{\partial \mathbf{q}(x)}{\partial \vec{n}} = \sprod{\nabla \mathbf{q}(x)}{\vec{n}(x)} = f(x) \qquad \forall x \in \partial \Omega,
				\label{eq:neumann}
			\end{equation}
			where $\vec{n}$ denotes the normal to the boundary $\partial \Omega$, $f(x)$ is a known scalar function and $\sprod{\cdot}{\cdot}$ denotes the inner product operator.\\
			In regards to the given geometry \ref{fig:mesh} two boundaries are present. The central cylinder is treated as no-slip wall condition, posing the special Dirichlet condition 
			\begin{equation*}
				\mathbf{q}(x) \times \vec{n} = U \times  \vec{n} \qquad \forall x \in \partial \Omega,
			\end{equation*}
			where $U$ denotes the wall velocity. \\
			The outer boundary is treated as Neumann boundary as prescribed in equation \ref{eq:neumann}. 
		
		\section{Finite Differences}\label{sec:finitedifferences}
			Let $f(x):\R \rightarrow \R$ be a continuous differentiable function. In the vicinity $h \in \R^{+}$ of $x$, $f(x + h)$ can be expressed as Taylor series 
			\begin{equation}
				f(x + h) = f(x) + h \left.\frac{\partial f}{\partial x}\right\vert_{x} + \frac{h^2}{2!} \left.\frac{\partial^2 f}{\partial x^2}\right\vert_{x} +
				\frac{h^3}{3!} \left.\frac{\partial^3 f}{\partial x^3}\right\vert_{x} + \dots +
				\frac{h^n}{n!} \left.\frac{\partial^n f}{\partial x^n}\right\vert_{x}
				\label{eq:taylorseries},
			\end{equation}
			where $\left.(\cdot)\right\vert_{x}$ means evaluated at point $(x)$.
			Higher order derivatives are unknown and as such simply neglected. Because commonly $h << 1$, higher order terms vanish as $h$ is sufficiently small, the factor decreases exponentially with the order of the term and additionally the factorial in the denominator grows. This produces an error of second order in $h$
			\begin{equation*}
				f(x + h) = f(x) + h \left.\frac{\partial f}{\partial x}\right\vert_{x} + \mathcal{O}(h^2).
			\end{equation*}
			Rearranging gives a first order approximation for the first derivative at $x$.
			\begin{equation}
				\left.\frac{\partial f}{\partial x}\right\vert_{x} = \frac{f(x + h) - f(x)}{h} + \mathcal{O}(h)
				\label{eq:fwdiff}
			\end{equation}
			Equation \ref{eq:fwdiff} is known as forward difference scheme.\\
			Similarly a Taylor series expansion can be used to approximate $f(x - h)$ as
			\begin{equation}
				f(x - h) = f(x) - h \left.\frac{\partial f}{\partial x}\right\vert_{x} + \frac{h^2}{2!} \left.\frac{\partial^2 f}{\partial x^2}\right\vert_{x} -
				\frac{h^3}{3!} \left.\frac{\partial^3 f}{\partial x^3}\right\vert_{x} + \dots +
				\frac{h^n}{n!} \left.\frac{\partial^n f}{\partial x^n}\right\vert_{x}
				\label{eq:taylorseriesneg}.
			\end{equation}
			Again neglecting higher order terms and rearranging gives   
			\begin{equation}
				\left.\frac{\partial f}{\partial x}\right\vert_{x} = \frac{f(x) - f(x - h)}{h} + \mathcal{O}(h)
				\label{eq:bwdiff}.
			\end{equation}
			Equation \ref{eq:bwdiff} is known as backward difference scheme.\\
			Subtracting equation \ref{eq:taylorseriesneg} from \ref{eq:taylorseries} gives 
			\begin{equation}
				f(x + h) - f(x - h) = 2 \left.\frac{\partial f}{\partial x}\right\vert_{x} + \frac{2 h^3}{3!} \left.\frac{\partial^3 f}{\partial x^3}\right\vert_{x}	+ \dots
				\label{eq:taylorsercent}.
			\end{equation}
			Rearranging and neglecting higher order terms gives the central difference scheme
			\begin{equation}
				\left.\frac{\partial f}{\partial x}\right\vert_{x} = \frac{f(x + h) - f(x - h)}{2h} + \mathcal{O}(h^2)
				\label{eq:centdiff}.
			\end{equation}
			Note the central difference scheme is second order accurate.\\
			Adding equation \ref{eq:taylorseriesneg} to \ref{eq:taylorseries} gives 
			\begin{equation}
				f(x + h) + f(x - h) = 2 \left.\frac{\partial f}{\partial x}\right\vert_{x} + \frac{2 h^2}{2!} \left.\frac{\partial^2 f}{\partial x^2}\right\vert_{x}	+ \frac{2 h^4}{4!} \left.\frac{\partial^4 f}{\partial x^4}\right\vert_{x} + \dots
				\label{eq:taylorsecder}.
			\end{equation}
			Rearranging for the second derivative gives a finite difference scheme of second order accuracy
			\begin{equation}
				\left.\frac{\partial^2 f}{\partial x^2}\right\vert_{x} = \frac{f(x + h) - 2 f(x) + f(x - h)}{h^2} + \mathcal{O}(h^2)
				\label{eq:secdiff}.
			\end{equation}
			
		\section{Polar Coordinates}
			As the utilized spatial discretization, given by the mesh in figure \ref{fig:mesh}, inherits rotational symmetry, the coordinate transform from Cartesian to polar coordinates is beneficial. In two dimensions cylinder coordinates coincide with polar coordinates as the non existing $z$ axis remains non transformed. \\
			\begin{figure}[h!]
				\centering
				\includegraphics[width=0.5\linewidth]{polar_cartesian.png}
				\caption{Relation of cartesian coordinate system to polar coordinate system. In three dimensions, the $z$-axis remains unchanged to achieve the cylinder coordinate system.}
				\label{fig:polar}
			\end{figure}
			The general polar coordinates $r \in \R^{+}$ and $\phi \in (-\pi,\pi]$,can be transformed to Cartesians $x$ and $y$ trough the geometric relation depicted in \ref{fig:polar}.  
			\begin{align}
				\begin{split}
					x &= r \cos{\phi} \\
					y &= r \sin{\phi} \\
					r &= \sqrt{x^2 + y^2} \\
					\phi &= arctan2(y,x)
				\end{split}\label{eq:geodep}
			\end{align}
			The transformation includes partial derivatives. The cartesian derivatives $\frac{\partial }{\partial x}$ and $\frac{\partial }{\partial y}$ can be expressed in terms of the polar coordinate derivatives:
			\begin{align*}
				\frac{\partial }{\partial x} &= \frac{\partial }{\partial \phi}\frac{\partial  \phi}{\partial x}+\frac{\partial }{\partial r}\frac{\partial r}{\partial x}\\
				\frac{\partial }{\partial y} &= \frac{\partial }{\partial \phi}\frac{\partial  \phi}{\partial y}+\frac{\partial }{\partial r}\frac{\partial r}{\partial y},
			\end{align*}
			where the geometric relation \ref{eq:geodep} yield:
			\begin{align*}
				\frac{\partial \phi}{\partial x} &= -\frac{y}{x^2+y^2} \:= -\frac{y}{r^2}\\
				\frac{\partial \phi}{\partial y} &= \frac{x}{x^2+y^2} \quad= \frac{y}{r^2}\\
				\frac{\partial r}{\partial x} &= \frac{x}{\sqrt{x^2+y^2}} = \frac{x}{r}\\
				\frac{\partial r}{\partial y} &= \frac{y}{\sqrt{x^2+y^2}} = \frac{y}{r}
			\end{align*}
			Similarly second derivatives can be derived as
			\begin{align}
				\begin{split}
					\frac{\partial^2}{\partial x^2} &= \frac{\partial^2}{\partial \phi^2}\frac{\partial^2 \phi}{\partial x^2} + \frac{\partial^2}{\partial r^2}\frac{\partial^2 r}{\partial x^2} + 2 \frac{\partial}{\partial \phi}\frac{\partial \phi}{\partial x}\frac{\partial}{\partial r}\frac{\partial r}{\partial x}\\
					\frac{\partial^2}{\partial y^2} &= \frac{\partial^2}{\partial \phi^2}\frac{\partial^2 \phi}{\partial y^2} + \frac{\partial^2}{\partial r^2}\frac{\partial^2 r}{\partial y^2} + 2 \frac{\partial}{\partial \phi}\frac{\partial \phi}{\partial y}\frac{\partial}{\partial r}\frac{\partial r}{\partial y}.
				\end{split}
				\label{eq:polsecder}
			\end{align}
			Note the mixed terms $\frac{\partial^2}{\partial r \partial \phi}$ arising in \ref{eq:polsecder}. As these are more difficult to compute, and the second derivatives are not individually required in this thesis, the Laplacian was chosen to obtain the sum of second derivatives. \\
			The Laplacian is the differential operator describing the divergence of the the gradient. Since the Navier-Stokes include the Laplacian operator, a direct treatment is beneficial.
			In two dimensional Cartesian's the Laplacian notes
			\begin{equation*}
				\Delta = \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2}
			\end{equation*} 
			In polar coordinates the Laplacian becomes 
			\begin{equation}
				\Delta = \frac{\partial^2}{\partial r^2} + \frac{1}{r} \frac{\partial}{\partial r}+ \frac{1}{r^2} \frac{\partial^2}{\partial \phi^2}
				\label{eq:pollaplace}
			\end{equation}	
			Note that \ref{eq:pollaplace} has only single variable partial derivatives. 
		
		\section{Control Theory}
			
		
		\section{Reduced Order Model}
			This section is formulated in accordance with \cite{ROWLEY2004115, Pinnau2008, brunton_kutz_2019, Arunajatesan20144, tubiblio70572}.
			\subsection{Proper Orthogonal Decomposition}
				Proper Orthogonal Decomposition, abbreviated POD, is a projection method finding a reduced order subspace in an optimal least square approximation. 
				\\
				Let $\Omega \in \R^n$ be a finite dimensional Hilbert space with inner product $\langle \cdot , \cdot \rangle_{\Omega}$ and induced norm $\norm{\cdot}_{\Omega} = \sqrt{\langle \cdot , \cdot \rangle_{\Omega}}$. Let \{$q_k \in \Omega| k=1,\dots,m$\} be an ensemble of snapshots with $m<n$ in discrete time where $q(u,v,p,x,t)$ s.t. 
				\begin{align*}
					\langle q , q \rangle_{\Omega} &= \int_{\Omega} u_1 u_2 + v_1 v_2 + p_1 p_2 \; dV \\
					\norm{q}_{\Omega} &= \sqrt{\langle q , q \rangle_{\Omega}}\\
					\bar{q} &= \frac{1}{T}\int_{T}q \; dt
				\end{align*}
				\\
				\subsubsection{Method of Snapshots}\label{sec:methodofsnapshots}
					Given the ensemble of data $\Q=$\{$q_k \in H|\;k=1,\dots,m$\}, find subspace $S$ spanned by $\phi_1,\dots,\phi_R \in \Omega$ and coefficients $a_1^1,\dots,a_1^R,\dots,a_m^1,\dots,a_m^R \in \R$ minimizing
					\begin{equation*}
					 \norm{\Q - \mathbf{\Phi}\Q}^2 \defgr \sum_{i=1}^{m} \norm{q_i - \sum_{r=1}^{R}\phi_r a_i^{r}}_{\Omega}^2
					\end{equation*} 
					where $a_i$ are the time activations of the spatial POD basis. The POD basis is constructed as linear combination of the given snapshots $q_i$ by
					\begin{equation*}
						\phi_r = \sum_{i=1}^{m} c_i^r q_i
					\end{equation*} 
					where $\vec{c}_k$ are the activations of snapshots.
					For all $R = 1,\dots,m$ the constraint
					\begin{equation}
						\begin{split}
							\sprod{\phi_i}{\phi_j}_{\Omega} = \delta_{ij}
						\end{split}\quad\quad\quad
						\begin{split}
							i,j = 1, \dots , m.
						\end{split}
						\label{eq:podortho}
					\end{equation}
					holds.
					\\
					Introducing the correlation matrix $\mathbf{K} \in \R^{m \times m}$ defined by
					\begin{equation*}
						\mathbf{K}_{ij} = \langle q_i , q_j \rangle_{\Omega}
					\end{equation*} 
					By definition, $\mathbf{K}$ is symmetric positive semi-definite matrix with real, non-negative ordered eigenvalues $\lambda_1 \geq \dots \geq \lambda_m \geq 0$.	Due to the construction of $\mathbf{K}$ the eigenvectors of the eigenvalue problem 
					\begin{equation*}
						\mathbf{K} \vec{c} = \lambda \vec{c}
					\end{equation*}
					are chosen as orthonormal basis to form the spatial POD modes $\phi_r$. The activations $\vec{c}_i$ are scaled by the corresponding eigenvalue $\lambda_i$
					to enforce the orthonormal condition in equation \ref{eq:podortho} s.t.
					\begin{equation*}
						\phi_r = \frac{1}{\lambda_r} \sum_{i}^{m} q_i \vec{c}^{\;r}_i
					\end{equation*}
					The activations $a_i$ for the reconstruction of $q_k$ are given by
					\begin{equation}
						a_i^{r} = \sprod{q_i}{\phi_r}
						\label{eq:podactcalc}
					\end{equation}
					Note that this method of snapshots introduced by Sirovich \cite{sirovich1987turbulence} is advantageous due the reduced dimensions of the eigenvalue problem constructed by the correlation matrix $K$ reducing the complexity from $n \times n$ to $m \times m$. 	
				\subsubsection{POD and Singular Value Decomposition}
					Given the ensemble of data $\Q=$\{$q_k \in H|\;k=1,\dots,m$\} with $\Q \in \R^{n \times m}$ there exist orthogonal matrices $\Phi \in \R^{n \times n}$ and $V \in \R^{m \times m}$ such that
					\begin{equation*}
						\Q = \Phi \Sigma V^T,
					\end{equation*}
					where $\Sigma \in \R^{n \times m}$ is diagonal with $diag(\Sigma) = \sigma_1 \geq \dots \geq \sigma_R > 0$ being singular values and $R = rank(\Q)$. The matrices $\Phi$ and $V$ are composed of the eigenvectors $\phi_i$ and $\tau_i$ of the covariance matrices $\Q \Q^T$ and $\Q^T\Q$ respectively and form an orthonormal basis s.t. $\Phi^T \Phi = \mathbf{I}$ and $V V^T = \mathbf{I}$ . 
					The decomposition allows representation of snapshots $q_i$ in terms of the right and left singular vectors such that
					\begin{equation*}
						q_i = \sum_{j=1}^{R} \sigma_j \phi_j v_{ij},
					\end{equation*}
					assuming $m<n$. The singular vectors are given as columns of $\Phi$ and $V$ respectively. \\
					Given the relations 
					\begin{equation}
						\begin{aligned}
							\Q v_j &= \sigma_j \phi_j \\
							\Q^T \phi_j &= \sigma_j v_j
						\end{aligned}\label{eq:svdrelations}
					\end{equation}
					it follows that
					\begin{equation}
						\Q^T Q v_j = \sigma_j^2 v_j,
					\end{equation}
					where $\Q^T \Q$ is a symmetric matrix with the eigenvalues being the square of the singular values $\sigma_j$. \\
					Note that in the case of of a snapshot matrix $\Q \in \R^{n \times m}$, where $n$ is the spatial dimension and $m$ denotes the number of snapshots in time, $\Phi$ corresponds to spatial singular vectors and $V$ to temporal singular vectors. 					
			\subsection{Galerkin Projection}\label{sec:gp}
				Given the POD decomposition 
				\begin{equation}
					q(\mathbf{x},t) = \sum_{i}^{r} a_i(t) \phi_i
					\label{eq:poddecomp}
				\end{equation}
				where $a_i$ is solely dependent on time and $\phi$ from space. $r$ is the chosen number of POD basis functions $\phi$ to reconstruct $q$. 
				Let a complex dynamical system be described by a system of nonlinear partial differential equations (PDEs) of a single spatial variable be modeled as
				\begin{equation}
					q_t = \mathbf{N}(q,q_x,q_{xx},\dots,x,t)
					\label{eq:nonlindyn}
				\end{equation}
				where the subscript denotes partial differentiation and $\mathbf{N}(\cdot)$ prescribes the generically nonlinear evolution.   
				Given that the state $q$ of the system is of high dimension $n>>1$ e.g. as value based vector for $n$ number of points in a fluid domain $\Omega$ with boundary $d\Omega$ the concept of model order reduction becomes increasingly beneficial. 
				Deploying equation \ref{eq:poddecomp} on the dynamical system \ref{eq:nonlindyn} results in 
				\begin{equation*}
					\sum_{k = 1}^{r} \phi_k \frac{d a_k}{d t} = \mathbf{N}(\sum_{i = 1}^{r} a_i \phi_i,\left(\sum_{i = 1}^{r} a_i \phi_i\right)_x,\left(\sum_{i = 1}^{r} a_i \phi_i\right)_{xx},\dots,x,t)
					\label{eq:decnonlindyn}
				\end{equation*}
				Utilizing the orthogonality and normality of the bases $\phi$
				\begin{equation*}
				\begin{split}
					\sprod{\phi_i}{\phi_j}_{\Omega} = \delta_{ij}
				\end{split}\quad\quad\quad
				\begin{split}
					i,j = 1, \dots , m.
				\end{split}
				\end{equation*}
				the projection of the POD modes onto equation \ref{eq:decnonlindyn} yields a system of $r$ coupled ordinary differential equations in $a_k$
				\begin{equation}
					\frac{d a_k}{d t} = \left\langle \mathbf{N}(\sum_{i = 1}^{r} a_i \phi_i,\left(\sum_{i = 1}^{r} a_i \phi_i\right)_x,\left(\sum_{i = 1}^{r} a_i \phi_i\right)_{xx},\dots,x,t), \phi_k \right\rangle 				\label{eq:projnonlindyn}
				\end{equation}
				The given nonlinear nature of $\mathbf{N}$ determines the mode-coupling that occurs between basis functions $\phi_i$ whereas the modal mixing is primarily produced by non-linearity.
				Note that the Galerkin method prescribed here can also be deployed for full order simulations such as Finite Element Simulation where spatial discretization is performed using linear shape functions resulting in the FEM-Galerkin method \cite{Asadzadeh_2020}. 
		. 
				
				
				
				
			\subsection{Inner products for Compressible Navier Stokes}
				The choice of inner product is essential for the quality of basis. The simplest choice of inner product over the fluid domain $\Omega$ is a naive summation over the product of fluid variables such as $\rho, u, v ,p$ in a two dimensional problem integrated over the domain volume defining the state of the dynamical system.
				\begin{equation}
					\sprod{q_i}{q_2} = \int_{\Omega} (\rho_1 \rho_2 + u_1 u_2 + v_1 v_2 + p_1 p_2) dV
					\label{eq:standsprod}
				\end{equation}
				Note that the inner product \ref{eq:standsprod} is nonphysical as the dimension of the flow variable $\rho, p ,u ,v$ mismatch. This problem may be solved by non-dimensionalization of the flow variables but then the choice of scaling parameters becomes critical. %continue in 13 section 4.2  
				\\
				Another solution is the introduction of an inner product with a direct physical interpretation in its induced norm. Given the inclusion of thermodynamic and kinematic variables a family of inner products is defined where under special bifurcation parameter the interpretation of the induced norm is either the integrated stagnation enthalpy or the integrated stagnation energy.   
				In the case of compressible flow the total energy is dependent on thermodynamic and kinematic variables. Given the thermodynamic equations for stagnation enthalpy and stagnation energy
				\begin{align}
					h_0 &= h + \frac{1}{2}(u^2+v^2)\label{eq:stagenth}\\
					e &= E + \frac{1}{2}(u^2+v^2),\label{eq:stagen}
				\end{align}
				where $h$ is the static enthalpy and $E = \frac{h}{\gamma}$ is the internal energy per unit mass.
				Considering the physical context the desired form of induced norm is 
				\begin{equation*}
					\frac{1}{2} \norm{q}_\alpha^2 = \int_{\Omega}\left( \alpha h + \frac{1}{2} (u^2+v^2)\right)dV
				\end{equation*}
				where $\alpha > 0$ is a constant. Note that the integral is not quadratic in all terms with $h$ appearing linearly. Choosing the flow variable $q(u,v,a)$ with $a^2 = (\gamma -1) h$ the family of inner products becomes 
				\begin{equation}
					\sprod{q_1}{q_2}_\alpha = \int_{\Omega}\left( u_1 u_2 + v_1 v_2 + \frac{2 \alpha}{\gamma -1 } a_1 a_2 \right)\label{eq:inprodmach}.
				\end{equation} 
				Choosing $\alpha = 1$ corresponds to using the integral of stagnation enthalpy \ref{eq:stagenth} as induced norm, while taking $\alpha = \frac{1}{\gamma}$ corresponds to using the integral of stagnation energy \ref{eq:stagen}. \\
				Note that if and only if the energy flux trough the boundary $d\Omega$ is $0$, the total energy is conserved by
				\begin{equation}
					\int_{\Omega}\left( \rho E + \frac{1}{2} \rho (u^2+v^2) \right) dV
				\end{equation}
			
			\subsection{Galerkin Systems}	
				Given the isentropic Navier Stokes equations from section \ref{sec:INS}, the equations in the two dimensional fluid domain, with respect to the mach number as thermodynamic variable, write:
				\begin{align}
					u_t &= -u u_x - v u_y - \frac{2}{\gamma -1 }a a_x + \mu (u_{xx} + u_{yy}) \nonumber\\
					v_t &= -u v_x - v v_y - \frac{2}{\gamma -1 }a a_y + \mu (v_{xx} + v_{yy})\label{eq:varisenns}\\
					a_t &= -u a_x - v a_y - \frac{\gamma -1}{2}a (u_{x} + v_{y}) \nonumber
				\end{align}
				Let the dynamic state variable $\mathbf{q} = (u,v,a)$, then equation \ref{eq:varisenns} becomes
				\begin{equation}
					\dot{\mathbf{q}} = \nu \mathbf{L}(\mathbf{q}) + \mathbf{Q}(\mathbf{q},\mathbf{q}), \label{eq:qdot}
				\end{equation}
				where 
				\begin{align}
					\mathbf{L}(\mathbf{q}) &= \begin{pmatrix}
						u_{xx} + u_{yy} \\ v_{xx} + v_{yy} \\ 0
					\end{pmatrix} \label{eq:L}\\
					\mathbf{Q}(\mathbf{q}^1,\mathbf{q}^2) &= - \begin{pmatrix}
						u^1 u^2_x - v^1 u^2_y - \frac{2}{\gamma - 1}a^1 a^2_x \\
						u^1 v^2_x - v^1 v^2_y - \frac{2}{\gamma - 1}a^1 a^2_y \\
						u^1 a^2_x - v^1 a^2_y - \frac{\gamma -1}{2}a^1 (u^2_x + v^2_y).
					\end{pmatrix} \label{eq:Q}
				\end{align}
				The superscript in equation \ref{eq:Q} only denotes the corresponding input state and not an exponent.  
				\\
				Using the expansion of state $\mathbf{q}$ in terms of any orthogonal basis functions $\phi$ as
				\begin{equation}
					\mathbf{q}(x,t) = \bar{\mathbf{q}}(x) + \sum_{i=1}^{r} a_i(t)\phi_i(x) \label{eq:centdecomp},
				\end{equation}
				where $\bar{\mathbf{q}}$ is fixed, typically being the mean of all snapshots used for POD determination. The POD computation is performed on the centered data also known as fluctuating flow 
				\begin{equation}
					\tilde{\mathbf{q}} = \mathbf{q} - \bar{\mathbf{q}} = \sum_{i=1}^{r} a_i(t)\phi_i(x).
				\end{equation}
				The resulting Galerkin system results from projecting the POD modes $\phi$ onto the governing equations \ref{eq:qdot} as described in section \ref{sec:gp}.
				\begin{equation}
					\dot{a}_k = \nu b^1_k + b^2_k + \sum_{i=1}^{r} (\nu L_{ik}^1 + L_{ik}^2)a_i + \sum_{i=1}^{r}\sum_{j=1}^{r} Q_{ijk}a_i a_j
					\label{eq:galerkinsystem}
				\end{equation}
				The coefficients for the system of ordinary differential equations follow by utilizing the distributive property of the inner product to project modes onto single terms of the governing equations s.t.
				\begin{align}
					\begin{split}
						b_k^1 &= \sprod{\mathbf{L}(\bar{\mathbf{q}})}{\phi_k} \\
						L_{ik}^1 &= \sprod{\mathbf{L}(\phi_i)}{\phi_k} \\
						Q_{ijk} &=\sprod{\mathbf{Q}(\phi_i,\phi_j))}{\phi_k}.
					\end{split}
					\begin{split}
						b_k^2 &= \sprod{\mathbf{Q}(\bar{\mathbf{q}},\bar{\mathbf{q}})}{\phi_k} \\
						L_{ik}^2 &=\sprod{\mathbf{Q}(\bar{\mathbf{q}},\phi_i) + \mathbf{Q}(\phi_i,\bar{\mathbf{q}}))}{\phi_k} \\
						\phantom{empty}					
					\end{split}
					\label{eq:galerkincoeffs}
				\end{align}
				The coefficients of equation \ref{eq:galerkinsystem} are constants which are computed before the reduced system is solved. Note that if $\bar{\mathbf{q}}$ is a steady solution of the Navier-Stokes such that 
				\begin{equation*}
					\nu \mathbf{L}(\bar{\mathbf{q}}) + \mathbf{Q}(\bar{\mathbf{q}},\bar{\mathbf{q}}) = 0
				\end{equation*} 
				then the affine terms vanish.  
				 
			
			\subsection{Stabilization}\label{sec:stabilization}
				The stability of the POD Galerkin method in the case of incompressible Navier Stokes is well researched. Instability is associated with a lack of inclusion for the pressure term in the projection and truncation errors due to the reduction of degrees of freedom. Considering the compressible Navier Stokes, unstable system behavior is more complex and less well understood. Referring to \cite{Iollo2000StabilityPO}, the inclusion of a stabilization scheme is necessary to form a stable solution to the system of ordinary differential equations. \cite{gloerfelt2008}
				\begin{itemize}
					\item \textbf{Artifical Viscosity} The stability of the system of ODEs can be achieved by empirically increasing the viscosity $\nu$ until stable dynamical behavior is achieved. According to \cite{couplet2003} and \cite{gloerfelt2008} the intermodal energy transfer bears similarity with the turbulent transfer and form a model closure problem. The lack of modal interaction produced by truncation and simplification in the projection model necessitates additional diffusive behavior. 
					\item \textbf{Sobolev Norm}	Choosing the inner product norm in a Sobolev space including a disspative part directly in the inner product evaluation \cite{gloerfelt2008} in the form
					\begin{align*}
						\sprod{q_1}{q_2} = &\int_{\Omega}\left( u_1 u_2 + v_1 v_2 + \frac{2 \alpha}{\gamma - 1}a_1 a_2\right) dV + \\
						&\epsilon \int_{\Omega}\left(\nabla u_1 \nabla u_2 + \nabla v_1 \nabla v_2 + \frac{2 \alpha}{\gamma - 1} \nabla a_1 \nabla a_2\right) dV,
					\end{align*}
					where parameter $\epsilon$ is tuned empirically.
					\item \textbf{Penalty Term} 
					Enforcing the correct boundary conditions in the Galerkin model by using a penalty term instead of including the pressure term was discussed briefly by \cite{gloerfelt2008}. The extension to the compressible regime consists notes
					\begin{equation*}
						\dot{a}_k = f_k(a) - G_k(a)
					\end{equation*}  
					where $f_k$ is the quadratic Galerkin projection of the compressible Navier-Stokes equations, $\dot{a}_k$ is the time evolution of mode activation and $G_k$ denotes a boundary penalty term
					\begin{equation*}
						G_k(a) = \tau \int_{\Omega} \phi_k \Upsilon (x) (q-q_\infty)dV.
					\end{equation*}
					with 
					\begin{equation*}
						\Upsilon(x) = \left\{ 
						\begin{array}{l l}
							1, \text{ if x is on }d\Omega\\ 
							0, \text{ otherwise.}
						\end{array} \right.
					\end{equation*}
					The variables $q$ are fixed to be their boundary values $q_\infty$ on $d\Omega$. Replacing $q$ by the POD decomposition
					yields
					\begin{equation*}
							G_k(a) = \tau \left( \sum_{i=1}^{r} a_i \int_{d\Omega} \phi_k \cdot \phi_i dS - \int_{d\Omega} \phi_k \cdot q_\infty dS \right)
					\end{equation*}
					Note that $\tau$ corresponds to the weight associated with compliance to the boundary condition and is tuned empirically to find the stabilized Galerkin model. 
					\item \textbf{Calibration} Given the non-calibrated model
					\begin{equation*}
						\dot{\mathbf{a}}^*(t) = f^*[\mathbf{a}^*(t)]
					\end{equation*}
					prescribed by the Galerkin model in vector form, the calibrated model corresponds to the second-order polynomial $f^\alpha$ minimizing 
					\begin{equation}
						J^\alpha = (1 - \alpha) \mathcal{E} + \alpha \mathcal{D}, \label{eq:minpolymod}
					\end{equation}
					where $\alpha$ is a calibration parameter, $\mathcal{E}$ a measure for the normalized error between a new model $f$ with coefficients $a$ and the hypothesized model $f^*$ deducted directly from snapshot data and $\mathcal{D}$ is penalty term for the distance between $f$ and $f^*$. $\mathcal{E}$ is defined as
					\begin{equation*}
						\mathcal{E}(f) = \frac{\overline{\norm{e(f,t)}^2}}{\overline{\norm{e(f^*,t)}^2}},
					\end{equation*}
					where $\norm{\cdot}$ denotes a norm of $\R^M$ and $\overline{\cdot}$ denotes arithmetic time average. As choice for $e(f,t)$ the gap between time derivatives of the optimal activations $a^o(t)$ and those obtained of the polynomial model $f$
					\begin{equation*}
						e(f,t) = \dot{a}^o(t) - f[a^o(t)]
					\end{equation*} 
					Let
					\begin{equation*}
						f = \sum_{k=1}^{P}y_k m_k,
					\end{equation*}
					where $y_k \in \R^P$ and $m_k$ form the natural monomial bases of the vector polynomial in $M$ variables of degree 2 $(P = M (M+1)(M+2)/2)$.\\
					The distance $\mathcal{D}$ is defined as
					\begin{equation*}
						\mathcal{D}(f) = \frac{\norm{f - f^*}^2}{\norm{f^*}^2}
					\end{equation*}
				where $\norm{f} = \sqrt{y^T y}$ is a seminorm. The minimization of \ref{eq:minpolymod} results in the vector $y^\alpha$ of the polynomial coefficients of $f^\alpha$ in the monomial basis. The calibration procedure amounts to solving a linear system due to choice of $e(f,t)$.
				\end{itemize}				
			\subsection{Control Methods}
				The methods of application of control for the reduced order model presented here, are proposed by \cite{Peraire2012}.
				\subsubsection{Control Function Method}\label{sec:controlfunction}
					The application of a control function is assumed to follow the superposition principle. The control function is simply the velocity field generated by a steady cylinder rotation under zero freestream velocity corresponding to a fixed potential vortex $\mathbf{q}_c$. The angular velocity of the cylinder chosen for the simulation of the potential vortex corresponds to a control input $\gamma = 1$. 
					Utilizing the POD decomposition \ref{eq:centdecomp} and the control function expansion the flow notes
					\begin{equation}
						\mathbf{q}(x,t) = \bar{\mathbf{q}} + \gamma(t)\mathbf{q}_c + \sum_{i=1}^{r} a_i(t)\phi_i(x),
						\label{eq:confuncdecomp}
					\end{equation}
					where $\gamma(t)$ denotes the control input and $\gamma(t) \mathbf{q}_c$ satisfies the non-homogeneous velocity boundary condition on the cylinder wall and the farfield condition.\\
					Deploying \ref{eq:confuncdecomp} in the isentropic formulation of \ref{eq:qdot} gives:
					\begin{align*}
						\dot{\mathbf{q}} &= \nu \mathbf{L}(\bar{\mathbf{q}}) + \nu \gamma  \mathbf{L}(\mathbf{q}_c) + \nu \sum_{i=1}^{r} a_i \mathbf{L}(\phi_i) \\ &+ \mathbf{Q}(\bar{\mathbf{q}},\bar{\mathbf{q}}) + \mathbf{Q}(\bar{\mathbf{q}},\mathbf{q}_c ) + \mathbf{Q}(\mathbf{q}_c ,\bar{\mathbf{q}}) + \mathbf{Q}(\mathbf{q}_c,\mathbf{q}_c)\\
						&+ \sum_{i=1}^{r} \big[\mathbf{Q}(\phi_i,\bar{\mathbf{q}})+\mathbf{Q}(\bar{\mathbf{q}},\phi_i)+\mathbf{Q}(\phi_i,\mathbf{q}_c)+\mathbf{Q}(\mathbf{q}_c,\phi_i)\big]\\
						&+ \sum_{i=1}^{r}\sum_{j=1}^{r} \mathbf{Q}(\phi_i,\phi_j).
					\end{align*}
					Note that the summation can be extended using $\mathbf{q}_c$ and $\bar{\mathbf{q}}$ as modes with activation $\gamma$ or $1$ respectively. Performing a Galerkin projection, described in \ref{sec:gp}, utilizing the control function and POD expansion in equation \ref{eq:confuncdecomp} the resulting Galerkin system becomes
					\begin{align}
						\dot{a}_k &= \nu b^1_k + b^2_k + \sum_{i=1}^{r} (\nu L_{ik}^1 + L_{ik}^2)a_i + \sum_{i=1}^{r}\sum_{j=1}^{r} Q_{ijk}a_i a_j \nonumber \\
						&+  \gamma (\nu d_k^1 + d_k^2) + \gamma^2 f_k + \sum_{i=1}^{r} \gamma g_{ik} a_i + h_k \frac{\partial \gamma}{\partial t}
						\label{eq:cfgalerkinsystem}
					\end{align}
					where 
					\begin{align*}
						\begin{split}
							b_k^1 &= \sprod{\mathbf{L}(\bar{\mathbf{q}})}{\phi_k} \\
							L_{ik}^1 &= \sprod{\mathbf{L}(\phi_i)}{\phi_k} \\
							d_k^1 &= \sprod{\mathbf{L}(\mathbf{q}_c)}{\phi_k} \\
							f_k &= \sprod{\mathbf{Q}(\mathbf{q}_c,\mathbf{q}_c)}{\phi_k}\\
							h_k &= \sprod{\mathbf{q}_c}{\phi_k}
						\end{split}
						\begin{split}
							b_k^2 &= \sprod{\mathbf{Q}(\bar{\mathbf{q}},\bar{\mathbf{q}})}{\phi_k} \\
							L_{ik}^2 &=\sprod{\mathbf{Q}(\bar{\mathbf{q}},\phi_i) + \mathbf{Q}(\phi_i,\bar{\mathbf{q}})}{\phi_k} \\
							d_k^2 &= \sprod{\mathbf{Q}(\mathbf{q}_c,\bar{\mathbf{q}}) + \mathbf{Q}(\bar{\mathbf{q}},\mathbf{q}_c)}{\phi_k} \\
							g_{ik} &= \sprod{\mathbf{Q}(\mathbf{q}_c,\phi_i) + \mathbf{Q}(\phi_i,\mathbf{q}_c)}{\phi_k} \\
							Q_{ijk} &=\sprod{\mathbf{Q}(\phi_i,\phi_j))}{\phi_k}					
						\end{split}
					\end{align*}
					Note the additional terms in the Galerkin system arise from the addition of the control function and the lack of orthogonality with respect to the POD basis.  				
				\subsubsection{Penalty Method}
					Enforcing the boundary condition in a "weak" fashion, the velocity on the cylinder wall may be written as 
					\begin{equation*}
						\mathbf{u} = \gamma R e_\theta - \epsilon \frac{\partial u}{\partial n},
					\end{equation*}
					where $\mathbf{u}$ is solely the velocity components, $R$ is the cylinder radius, $e_\theta$ the unit tangent vector and $\epsilon$ a weight parameter. Utilizing the alternative boundary condition in its derivative form
					\begin{equation}
						\frac{\partial u}{\partial n} = - \frac{\mathbf{u} - \gamma R e_\theta}{\epsilon}, \label{eq:pmboundaryterm}
					\end{equation}
					the boundary condition may be imposed in a weak form as surface integral in the Galerkin projection. For $\epsilon \rightarrow 0$ , the cylinder boundary converges to the original cylinder boundary condition. Even though $\phi_i$ are non-zero on the cylinder wall, the flow trough the wall is still $0$, s.t. $\phi_i \cdot n = 0$. 
					\\
					The arising penalty term $d_i$ is an additional term in the Galerkin system s.t. \ref{eq:galerkinsystem} yields
					\begin{equation}
						\dot{a}_k = \nu b^1_k + b^2_k + \sum_{i=1}^{r} (\nu L_{ik}^1 + L_{ik}^2)a_i + \sum_{i=1}^{r}\sum_{j=1}^{r} Q_{ijk}a_i a_j - (d_k^1 - \gamma d_k^2)
						\label{eq:pmgalerkinsystem}.
					\end{equation}
					The penalty term is prescribed by the integral formulation
					\begin{equation*}
						d_k(a) = - \tau \int_{\Omega} \phi_k \cdot \Upsilon(x)(\mathbf{q} - \mathbf{q}_\infty) dV
					\end{equation*}
					where 
					\begin{equation*}
						\Upsilon(x) = \begin{cases}
							1, \text{ if x is on } \partial \Omega, \\
							0, \text{ otherwise.}
						\end{cases}
					\end{equation*}
					and $\mathbf{q}_\infty$ are the set boundary values $\gamma R e_\theta$. It yields
					\begin{equation}
						d_k(a) = - \tau \left( \sum_{i=1}^{r} a_i \int_{\partial \Omega} \phi_k \cdot \phi_i dS - \int_{\partial \Omega} \phi_k \cdot \mathbf{q}_\infty dS \right).
						\label{eq:penalty}
					\end{equation}
					where the weight parameter $\tau$ is tuned empirically and determines the strength of the imposition of boundary conditions. With respect to \ref{eq:pmboundaryterm}, the parameter $\epsilon$ is included in the weight $\tau$ in \ref{eq:penalty}. The additional term $d_k^1$ and $d_k^2$ are concluded from \ref{eq:penalty} as
					\begin{align*}
						d_k^1 &= - \tau \sum_{i=1}^{r} a_i \int_{\partial \Omega} \phi_k \cdot \phi_i dS\\
						d_k^2 &= \tau \int_{\partial \Omega} \phi_k \cdot \mathbf{q}_\infty^0 dS.
					\end{align*}
					where $\mathbf{q}_\infty^0$	corresponds to the state of a fixed cylinder rotation with $\gamma_0$. 
					
			\subsection{Optimal Control}
				
			
		\section{Temporary}
			Given the decomposition \ref{eq:confuncdecomp} provided by the control function method, the determination of a suitable $\gamma(t)$ satisfying initial conditions $\gamma (0) = 0$ by optimizing a given cost function follows the general form
			\begin{equation}
				E(\vec{a},\gamma) = \int_{0}^{T} f(\vec{a},\gamma) dt,
				\label{eq:gencostunction}
			\end{equation}			
			where $\vec{a}$ is a vector containing the mode amplitudes $a_k$. 
			An iterative algorithm can be deployed optimizing $\gamma(t)$ by minimizing the cost function given in equation \ref{eq:gencostunction}. For each iteration a gradient function $G(\vec{a}^i,\gamma^i)$ satisfying
			\begin{equation*}
				\delta E = G(\vec{a}^i,\gamma^i)\delta \gamma
			\end{equation*}
			is evaluated and utilized in a steepest descent update
			\begin{equation}
				\gamma^{i+1} = \gamma^i - \alpha_{i}G^{i}.\label{eq:steepestdescent}
			\end{equation}
			This satisfies $E(\gamma^{i+1}) \leq E(\gamma^{i})$ and therefore provides a robust well known method to determine the optimal $\gamma$ for a given time span $T$.\\ 
			The efficient calculation of the gradient function is accomplished using ideas of Optimal Control Theory whereas the system dynamics are imposed onto the control problem via Lagrangian multipliers s.t. the Control Function method is replaced by
			\begin{align}
				\begin{split}
					E(\vec{a},\gamma) &= \int_{0}^{T} f(\vec{a},\gamma) dt - \sum_{k}^{R} \int_{0}^{T} \phi_k (\dot{a}_k - \nu b^1_k - b^2_k - \sum_{i=1}^{r} (\nu L_{ik}^1 + L_{ik}^2)a_i \\ &- \sum_{i=1}^{r}\sum_{j=1}^{r} Q_{ijk}a_i a_j - \gamma (\nu d_k^1 + d_k^2) - \gamma^2 f_k - \sum_{i=1}^{r} \gamma g_{ik} a_i - h_k \frac{\partial \gamma}{\partial t}) dt,
				\end{split}\label{eq:optimgalerkin}
			\end{align}
			where $\{ \phi_k, k = 1, \dots, R\}$ are co-state variables. If and only if the activations $a_k$ satisfy the Galerkin system \ref{eq:galerkinsystem}, the minimization of equation \ref{eq:optimgalerkin} is equivalent to minimizing \ref{eq:gencostunction}, since the additional terms are identical to zero for arbitrary $\phi_k$. \\
			Taking the first variation of equation \ref{eq:optimgalerkin} yields
			\begin{align}
				\begin{split}
						\delta E(\vec{a},\gamma) &= \int_{0}^{T}(  \sum_{k=1}^{R} \frac{\partial f}{\partial a_k} \delta a_k + \frac{\partial f}{\partial \gamma} \delta \gamma )dt - \sum_{k=1}^{R} \int_{0}^{T} \phi_k (\frac{d \delta a_k}{d t} - \sum_{i=1}^{r} (\nu L_{ik}^1 + L_{ik}^2) \delta a_i \\ &- \sum_{i=1}^{r}\sum_{j=1}^{r} (Q_{ijk} a_i \delta a_j + Q_{ijk} \delta a_i a_j) - (\nu d_k^1 + d_k^2)\delta \gamma - 2 \gamma f_k \delta \gamma - \delta \gamma \sum_{i=1}^{r} g_{ik} a_i \\ &- \sum_{i=1}^{r} \gamma g_{ik} \delta a_i - h_k \frac{\partial \delta \gamma}{\partial t}) dt.
				\end{split}\label{eq:deltaE}
			\end{align}
			Integration by parts and separation of variations in $\gamma$ and $a_k$ gives
			\begin{align*}
				\begin{split}
					\delta E(\vec{a},\gamma) &= \sum_{k=1}^{R} \int_{0}^{T}(
					\frac{d \phi_k}{d t} + \sum_{i=1}^{R}[\nu L^1_{ik} + L^2_{ik} + \sum_{j=1}^{R} (Q_{ijk} + Q_{jik}) a_j + \gamma g_{ik}  ] \phi_i + \frac{\partial f}{\partial a_k}
					) \partial a_k dt \\ &+ \int_{0}^{T}( \sum_{k=1}^{R} (h_k \frac{d \phi_k}{d t} + [\nu d^1_k + d^2_k + \sum_{i=1}^{R} g_{ik} a_i + 2 \gamma f_k] \phi_k)
					+ \frac{\partial f}{\partial \gamma}
					) \partial \gamma dt \\ &- \sum_{k=1}^{R} ([ \phi_k \delta a_k ]_0^T + [h_k \phi_k \delta \gamma ]_0^T).
				\end{split}
			\end{align*} 
			Since initial conditions $a_k^0$ and $\gamma^0$ are given, only variations satisfying $\delta a_k(0)=0$ and $\delta \gamma(0)=0$ are considered. Therefore if $\phi_k$ is constrained to satisfy 
			\begin{equation}
				\begin{split}
					\frac{d \phi_k}{d t} = \sum_{i=1}^{R} A_{ik} \phi_i - \frac{\partial f}{\partial a_k},
				\end{split}\qquad
				\begin{split}
					\phi_k(T) = 0,
				\end{split}\qquad
				\begin{split}
					k = 1,\dots,R
				\end{split}\label{eq:constraintproblem}
			\end{equation}
			where 
			\begin{equation*}
				A_{ik} = - [\nu L^1_{ik} + L^2_{ik} + \sum_{j=1}^{R} (Q_{ijk} + Q_{jik}) a_j + \sum_{i=1}^{R} \gamma g_{ik}],
			\end{equation*} equation \ref{eq:deltaE} reduces to 
			\begin{equation*}
				\delta E(\vec{a},\gamma) = \int_{0}^{T} (\sum_{k=1}^{R}( h_k \sum_{i=1}^{R} A_{ik} \phi_i + [\nu d^1_k + d^2_k + \sum_{i=1}^{R} g_{ik} a_i + 2 \gamma f_k]\phi_k - h_k \frac{\partial f}{\partial a_k})+ 
				\frac{\partial f}{\partial \gamma} )\delta \gamma d t.
			\end{equation*}
			The problem employed as constraint on $\phi_k$, given in equation \ref{eq:constraintproblem}, describes a linear initial value problem that needs to be solved in reverse time for the $R$ co-state functions $\phi_k(t)$.\\
			Since the given Galerkin system is already discretized in the temporal domain, the unknown control function $\gamma(t)$ is parameterized using a sinus expansion
			\begin{equation*}
				\gamma(t) \approx \gamma(0)(1 - \frac{t}{T}) + \sum_{m=1}^{N_d} \beta_m \sin({\frac{m \pi t}{2 T}}),
			\end{equation*}
			where $\beta^s$ contains the $N_d$ design variables $\beta^s_m$. The update is computed via the discrete analogue of equation \ref{eq:steepestdescent}
			\begin{equation*}
				\beta^{s+1} = \beta^s - \alpha_s G^s,
			\end{equation*}
			where the components $G_m^n$ of the discrete gradient vector $G^n$ are computed as
			\begin{align*}
				G_m^s &= \Delta t \sum_{n=0}^{N_t}\{(\sum_{k=1}^{R}(h_k \sum_{i=1}^{R} A_{ik}^{sn} \phi_i + [\nu d^1_k + d^2_k + \sum_{i=1}^{R} g_{ik} a_i^{sn} + 2 \gamma^{sn} f_k] \phi_k^{sn} \\
				&- h_k (\frac{\partial f}{\partial a_k})^{sn}) + (\frac{\partial f}{\partial \gamma})^{sn}) \sin({\frac{m \pi n \Delta t }{2 T}}) \}
			\end{align*}
			where superscript $s$ denotes the update step, $n$ denotes time level and $N_t = \frac{T}{\Delta t}$.
	
	\chapter{Data Generation}\label{cha:datagen}
		\section{Vortex Shedding}\label{sec:vortshed}
			The fluid flow around a two dimensional circular cylinder is well studied benchmark problem utilized for validation and methodological development. Given the spatial discretization \ref{sec:spacediscr}, the simulation data is generated with SU2 7.1.1 Blackbird utilizing the implemented compressible finite volume Navier Stokes solver.\\
			The problem simulated considers laminar flow at $Re=100$, producing the well known vortex shedding behavior. For comparison purposes and generalization, the fluid velocity is altered to three different settings differentiating the influence of compressible effects in the flow solution. For this purposes the mach number was chosen to span $Ma \in [0.01,0.1,0.6]$ with the respective freestream velocity $u_\infty \in [3.40297\frac{m}{s}, 34.0297\frac{m}{s}, 204.178\frac{m}{s}]$.\\
			Since the discussion and questioning of the simulation configuration is not the primary focus of this thesis, only a brief description of the simulation setup is given here. \\		
			The parameter adaptation of density and static pressure in SU2 is used to achieve the overall problem setting. As part of the fluid model, a constant viscosity air model is assumed. The spatial gradients necessary in the Navier Stokes are computed via a weighted least-square cell average \cite{white2019} combined with Vankats limiter \cite{VENKATAKRISHNAN1995120}. The convection term is solved via a ROE scheme \cite{Toro2009}. The time discretization chosen is the backward Euler method or implicit Euler with dual time-stepping method of second order \cite{Nordstroem_Ruggiu_2019}. Although the static pressure is adopted to meet the problem definition, non-dimensionalization of the Navier-Stokes computation allows arbitrary scaling. 
		\section{Potential Vortex}
			For the application of the control function method a potential vortex is required, serving as additional basis of the control affine system. The potential vortex is simulated using a steady Navier Stokes solver with a freestream velocity $0.0\frac{m}{s}$, where only the steady wall velocity is specified defined by its angular velocity. The magnitude of the potential vortex is defined by the speed of the moving wall and corresponds to a control application of magnitude $1$. 
			%tbd angular velocity of potential vortex
				
	\chapter{Results}
		Since this thesis is focused on the application of reduced order models accompanied by methodological verification and validation, multiple free stream velocities were chosen as ground of comparison. Due to the general homogeneous results, only results corresponding to $Ma = 0.6$ are depicted in this section although conclusions are drawn from all three velocity configurations.   
		\section{Simulation}
			In accordance with chapter \ref{cha:datagen}, datasets were generated for three different mach numbers to compare the presented methods in the general context of the compressible Navier-Stokes. The error estimation according to \cite{compinccomp2013} shows $<3\%$ error in low mach flows ($Ma<0.2$), where the error between incompressible and compressible Navier Stokes is linked directly the fluid velocity. \\
			The different configurations were chosen to cover the range of incompressible to fully compressible flows with one case of transitional mach. The differentiation between these cases serves as basis for comparison and validation of the methods. \\
			The simulation is performed with the software package SU2, Multiphysics Simulation and Design Software. "The SU2 suite is an open-source collection of C++ based software tools for performing Partial Differential Equation (PDE) analysis and solving PDE-constrained optimization problems" \cite{su2code}. For a fixed freestream velocity with given Reynolds number, the software acts on the idea of a free variable, here the static pressure, to meet the required fluid problem. \\ 
			The initialization is with respect to the freestream condition and thermodynamic variables. Due to the unsteady setting, initially the solution approaches the steady solution found at $Re = \infty$ or $Re \approx 0$. After some time, the fluid solution behind the cylinder starts deflecting either upwards or downwards until a vortex detaches and the deflection drifts in the opposite direction. The alternately clockwise and counter-clockwise rotating vortexes detach in fixed time intervals and remain dissipating momentum until they disappear in the boundary or fade out. The temporal solution converges towards a periodic oscillation displayed by the vortex shedding. \\
			Since the simulation in SU2 requires time stepping, a well-considered choice comes from established knowledge about the connection of geometric and freestream fluid parameters regarding the vortex shedding frequency determined by the Strouhal number.\\
			For a given Reynolds number $Re=100$ and the geometric setting, the Strouhal number yields $St = 0.16$ \cite{jiang_cheng_2017}. The general relation is
			\begin{equation*}
				St = \frac{f L}{u_\infty},
			\end{equation*}
			where $f$ is the vortex shedding frequency, $L$ is the characteristic length and $u_\infty$ the freestream velocity. The characteristic length is given by the cylinders diameter $L = 1m$, while the freestream velocity is given for each configuration by the mach number described in section \ref{sec:vortshed}. The Strouhal number is fixed due to the reynolds configuration, therefore 
			\begin{equation*}
				f = \frac{St \cdot u_\infty}{L} = \frac{1}{T},
			\end{equation*}
			where $T$ is the time for one shedding period.
			Supplementary, the assumption is made that each vortex shedding period is  resolved with greater than $ 50-100$ time steps to accurately portray the complex flow interaction. The chosen time steps, frequencies and shedding period are depicted in table \ref{tab:simpara}. The finer temporal resolution for the high mach cases were chosen to guarantee a sufficient accuracy. 
			\begin{table}[h!]
				\centering
				\begin{tabular}{ l l l r }
					\hline
					Frequency $f$ & Time period $T$& Freestream Velocity $u_\infty$ & Time Step $\Delta t$ \\
					\hline
					$0.54448 s^{-1}$ & $1.83661 s$ & $3.40297\frac{m}{s}$  & $0.02 s$ \\
					$5.44475 s^{-1}$ & $0.18366 s$ & $34.0297\frac{m}{s}$  & $0.001 s$ \\
					$32.66848 s^{-1}$ & $0.03061 s$ & $204.178\frac{m}{s}$  & $0.0001 s$ \\
					\hline
				\end{tabular}
				\caption{Simulation parameters for datasets at $Ma \in [0.01,0.1,0.6]$ with correspond velocities.}\label{tab:simpara}
			\end{table}
			
			 
		\section[POD]{Proper Orthogonal Decomposition}\label{sec:solpod}
			The proper orthogonal decomposition is performed using a vectorized state representation based on the system dynamic variables. 
			The state vector is achieved by flattening the solution according to the number of grid points $n$ and joining the state dependent variable solution along the existing axis, resulting in a $3n$ long state vector for each time step $t$. Choosing the isentropic Navier-Stokes as governing equations for the constructed reduced order model, the state variable becomes $q=(u,v,a)$, but can be fitted to any set of variables describing the temporal dynamics of the system according to the governing equation. \\
			Computation via the Method of Snapshots from section \ref{sec:methodofsnapshots} and the inner product of equation \ref{eq:inprodmach} over five vortex shedding periods with the mean subtracted, employing a centered decomposition 
			\begin{equation*}
				\mathbf{q}(x,t) = \bar{\mathbf{q}} + \sum_{i=1}^{r} a_i(t)\phi_i(x),
			\end{equation*}
			yields the pod modes $\phi_i$. For visualization and universality the POD modes are computed from normalized data by scaling with the inverse of the freestream velocity. The resulting time averaged flow fields are pictured in figure \ref{fig:flowavg0.6} and \ref{fig:averageFlow}. The time average shows similarity to a steady solution found in the case of $Re = \infty$ or $Re \approx 0$\cite{islam2013}. \\
			\begin{figure}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 8cm 1.5cm,clip]{mach_0.6/mach_0.6_POD_q_avg.png}
				\caption{Normalized, time average flow at mach $0.6$.}
				\label{fig:flowavg0.6}
			\end{figure}
			The first eight POD basis functions, with their x-directional velocity component, are depicted in figure \ref{fig:podma0.01}, \ref{fig:podma0.1} and \ref{fig:podma0.6}.
			\begin{figure}[h!]
				\begin{subfigure}{0.5\textwidth}
					\centering
					\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.6/pod_modes/mach_0.6_POD_0.png}
					\caption{Eigenmode 0}
				\end{subfigure}
				\begin{subfigure}{0.5\textwidth}
					\centering
					\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.6/pod_modes/mach_0.6_POD_1.png}
					\caption{Eigenmode 1}
				\end{subfigure}
				\newline
				\begin{subfigure}{0.5\textwidth}
					\centering
					\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.6/pod_modes/mach_0.6_POD_2.png}
					\caption{Eigenmode 2}
				\end{subfigure}
				\begin{subfigure}{0.5\textwidth}
					\centering
					\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.6/pod_modes/mach_0.6_POD_3.png}
					\caption{Eigenmode 3}
				\end{subfigure}
				\newline
				\begin{subfigure}{0.5\textwidth}
					\centering
					\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.6/pod_modes/mach_0.6_POD_4.png}
					\caption{Eigenmode 4}
				\end{subfigure}
				\begin{subfigure}{0.5\textwidth}
					\centering
					\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.6/pod_modes/mach_0.6_POD_5.png}
					\caption{Eigenmode 5}
				\end{subfigure}
				\newline
				\begin{subfigure}{0.5\textwidth}
					\centering
					\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.6/pod_modes/mach_0.6_POD_6.png}
					\caption{Eigenmode 6}
				\end{subfigure}
				\begin{subfigure}{0.5\textwidth}
					\centering
					\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.6/pod_modes/mach_0.6_POD_7.png}
					\caption{Eigenmode 7}
				\end{subfigure}
				\caption{Leading eight POD basis functions depicted by the velocity in x-direction for mach $0.6$ flow with centered data.}
				\label{fig:podma0.6}
			\end{figure} 
			The POD eigenmodes of the flow field are categorized in complementary sets consisting of two subsequent eigenvectors. The spatial patterns displayed in the POD modes resemble multiples of the vortex length. The leading two eigenmodes resemble the coarse vortex shape with a spatial drift differentiating them, the following eigenmodes resemble higher frequency oscillation complementing the main flow structure. The modes display clear boundaries between the flow structures and with increasing complementary set, the region of influence of the mode shrinks in length, but also detaches further from the cylinder structure. \\
			Comparing the different mach datasets, the vortex scale increases with decreasing freestream velocity. The influence length of POD modes behind the cylinder decreases since the momentum of vortexes is smaller with lower velocity magnitude therefore the disturbances fades away faster. \\   
			\begin{figure}[h!]
				\includegraphics[width=0.6\linewidth,trim=0.5 0.5 1.5cm 1.5cm,clip]{mach_0.6/POD_Eigenvalues_0.6.png}
				\caption{Eigenvalues corresponding to POD modes computed in decomposition at mach $0.6$}
				\label{fig:eig0.6}
			\end{figure}
			The eigenvalues of the leading pod modes are displayed in \ref{fig:eig0.6} and \ref{fig:podeig}. The eigenvalues follow a typical eigendecomposition distribution decreasing logarithmically. The complementary sets are standing out by producing a slight staircase pattern in the logarithmic eigenvalue plots. \\			
			In the case of nearly incompressible flow, the leading two eigenmodes capture more than $99\%$, the leading four eigenmodes more than $99.99\%$ and the leading six eigenmodes more than $99.9999\%$ from the energy of the full model. At moderate mach number the energy captured is slightly decreased due the more complex flow structure and the developing compressible effects. More than $98\%$ of the energy is captured by the leading two, more than $99.8\%$ by the leading four and more than $99.99\%$ by the leading six eigenmodes. This decrease in energy capture is further intensified for the high mach scenario were compressible effects are amplified. Still, $95\%$ is captured in the leading two eigenmodes, $99.4\%$ is captured in the leading four eigenmodes and $99.6\%$ is captured in the leading six eigenmodes.\\

		\section{Optimal Model}
			\subsection{POD Activation}
				Projecting the POD modes from section \ref{sec:solpod} onto the simulation snapshots \ref{eq:podactcalc} gives rise to the optimal POD model. The optimal activations are computed for the leading eight eigenmodes of each dataset and are depicted in \ref{fig:podactiv0.01}, \ref{fig:podactiv0.1} and \ref{fig:podactiv0.6}.\\
				\begin{figure}[h!]
					\begin{subfigure}{0.5\textwidth}
						\centering
						\includegraphics[width=\linewidth]{mach_0.6/activation/mach_0.6_pod_activ_eig_0_1.png}
						\caption{Eigenmode 0 and 1}
					\end{subfigure}
					\begin{subfigure}{0.5\textwidth}
						\centering
						\includegraphics[width=\linewidth]{mach_0.6/activation/mach_0.6_pod_activ_eig_2_3.png}
						\caption{Eigenmode 2 and 3}
					\end{subfigure}
					\newline
					\begin{subfigure}{0.5\textwidth}
						\centering
						\includegraphics[width=\linewidth]{mach_0.6/activation/mach_0.6_pod_activ_eig_4_5.png}
						\caption{Eigenmode 4 and 5}
					\end{subfigure}
					\begin{subfigure}{0.5\textwidth}
						\centering
						\includegraphics[width=\linewidth]{mach_0.6/activation/mach_0.6_pod_activ_eig_6_7.png}
						\caption{Eigenmode 6 and 7}
					\end{subfigure}
					\caption{Optimal activations for the leading eight eigenmodes grouped into complementary pairs for the dataset with $Ma=0.6$.}
					\label{fig:podactiv0.6}
				\end{figure} 
				The activations inherit the periodic behavior of the solution. In similarity to a Fourier basis, the complementary modes present the spatial shift while with increasing mode number the spatial frequency increases. This behavior transfers to the temporal domain represented by the optimal activations. Here the importance of the modes is measured by the amplitude. With increasing complementary set the amplitudes decreases while the frequency increases. The first pair of modes present activations according to the shedding frequency of the dominant vortex pattern, the second pair doubles the shedding frequency, the third pair  triples the shedding frequency. While the shedding frequency increases the amplitude decreases logarithmically. This pattern continues with increasing mode pair. Especially in eigenmode $6$ and $7$, the broad vortex shedding period is additionally visible in the activations, manifesting as limiting amplitude oscillation.  
			\subsection{Reconstruction}
			 	The reconstruction is effectively the potential of the POD modes to describe the dynamics of the reduced order model. By choosing a low number of POD modes, the capability for stable system dynamics becomes increasingly difficult to obtain due to truncation error and the simple reduction in the degrees of freedom for the system to propagate. \\
			 	This problem does not arise with the optimal model since the model is directly derived from the full order simulation and therefore does not inherit any approximation error per se. The error in the reconstruction arises solely from the exclusion of POD modes, effectively excluding the information contained in them. 
			 	For comparison, two snapshots and the associated reconstruction with two, four and six POD modes is displayed for each dataset in figures \ref{fig:podrec0.01},\ref{fig:podrec0.1} and \ref{fig:podrec0.6}. \\
			 	\begin{figure}[h!]
			 		\hspace{3cm} Snapshot $0$ \hfill Snapshot $50$ \hspace{2.2cm}
			 		\newline
			 		\begin{turn}{90}
			 			\hspace{0.1cm}
			 			Ground Truth
			 		\end{turn}
			 		\begin{subfigure}[b]{0.48\textwidth}
			 			\centering
			 			\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/reconstruction/mach_0.6_gt_snap_0.png}
			 		\end{subfigure}
			 		\begin{subfigure}[b]{0.48\textwidth}
			 			\centering
			 			\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/reconstruction/mach_0.6_gt_snap_50.png}
			 		\end{subfigure}
			 		\newline
			 		\begin{turn}{90}
			 			\hspace{0.6cm}
			 			2 Modes
			 		\end{turn}
			 		\begin{subfigure}[b]{0.48\textwidth}
			 			\centering
			 			\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/reconstruction/mach_0.6_rec_2_modes_snap_0.png}
			 		\end{subfigure}
			 		\begin{subfigure}[b]{0.48\textwidth}
			 			\centering
			 			\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/reconstruction/mach_0.6_rec_2_modes_snap_50.png}
			 		\end{subfigure}
			 		\newline
			 		\begin{turn}{90}
			 			\hspace{0.6cm}
			 			4 Modes
			 		\end{turn}
			 		\begin{subfigure}[b]{0.48\textwidth}
			 			\centering
			 			\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/reconstruction/mach_0.6_rec_4_modes_snap_0.png}
			 		\end{subfigure}
			 		\begin{subfigure}[b]{0.48\textwidth}
			 			\centering
			 			\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/reconstruction/mach_0.6_rec_4_modes_snap_50.png}
			 		\end{subfigure}
			 		\newline
			 		\begin{turn}{90}
			 			\hspace{0.6cm}
			 			6 Modes
			 		\end{turn}
			 		\begin{subfigure}[b]{0.48\textwidth}
			 			\centering
			 			\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/reconstruction/mach_0.6_rec_6_modes_snap_0.png}
			 		\end{subfigure}
			 		\begin{subfigure}[b]{0.48\textwidth}
			 			\centering
			 			\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/reconstruction/mach_0.6_rec_6_modes_snap_50.png}
			 		\end{subfigure}
			 		\caption{Snapshots at two time steps in the top with snapshot reconstruction based on two, four and six modes below for the dataset at $Ma=0.6$.}
			 		\label{fig:podrec0.6}
			 	\end{figure}
		 	 	Choosing the the number of POD modes for reconstruction to be greater than four, results in visibly no distinction to the ground truth. Taking only the leading two modes for reconstruction the differences are visible in the bend of vortex detachment. The vortex structure near the cylinder is more defined than the ground truth, the missing information is completely contained in further modes as including additional modes proofs. \\
		 	 	The reconstruction error measured as mean squared error over the number of POD modes utilized for reconstruction is displayed in \ref{fig:podrecerror}.
		 	 	\begin{figure}
		 	 		\centering
		 	 		\includegraphics[width=0.7\linewidth,trim=0.5 0.5 1.5cm 1.5cm,clip]{mach_0.6/reconstruction/mach_0.6_rec_error.png}
		 	 		\caption{Semi-logarithmic y-axis plots displaying the reconstruction error at $Ma=0.6$, measured as mean squared error, over the number of pod modes chosen for reconstruction of the flow field.}
		 	 	\end{figure}
	 	 		The reconstruction is visually indistinguishable from the real snapshots, after considering 4 or more POD modes. The remaining error is proportional to the amplitude of the activations and the truncated POD modes. Overall the reconstruction capabilities of the POD modes emphasize the approach of the reduced order model by limiting the degrees of freedom of the dynamical system to the mainly contributing flow modes.
		\section{POD ROM}
			For the construction of the reduced order model, the governing equations were chosen to be the isentropic navier stokes introduced in section \ref{sec:INS}. The accompanying simplification in the Galerkin system following the galerkin projection, are quadratic dependencies of the DOF variables instead of the original cubic dependence, derived by projecting onto the fully compressible navier stokes \cite{ROWLEY2004115, gloerfelt2008}. The Galerkin system derived for the isentropic model is subject to convection and diffusion operators denoted as $\Q$ and $\mathbf{L}$ for the computation of coefficients \ref{eq:galerkincoeffs}. The coefficients are computed pre-simulation, as they only depend on the initial data-based decomposition into POD modes, mean flow and a defined inner product. 
			\subsection{Galerkin Coefficients}
				The convection and diffusion operators require first and second spatial derivatives for computation. These have to be obtained directly from the spatial discretized snapshot data and the geometric context of grid points. The method chosen for determining spatial derivatives is the finite differences method introduced in section \ref{sec:finitedifferences}. Although further methods were considered, namely polynomial fitting and compact schemes, due to the simplicity of the method, utilizing a four point stencil and coordinate transform, and the initial success, the central finite difference scheme was deployed for first and second spatial derivatives. For completion, the boundary conditions on $\partial \Omega_{cyl}$ and $\partial \Omega_{far}$ are known and can be set manually. The transformation to polar coordinates allows the simple finite difference method to be applied over the whole mesh structure. \\
				For each grid point, except wall and farfield nodes, the four point stencil yields neighboring nodes in $\pm$ radial and angular direction. The central difference scheme can be applied in angular direction at the farfield boundary as the boundary condition states the normal derivative to be zero (Neumann boundary).
				\begin{equation}
					\frac{\partial \mathbf{q}(x)}{\partial \vec{n}} = \sprod{\nabla \mathbf{q}(x)}{\vec{n}(x)} = 0 \qquad \forall x \in \partial \Omega_{far},
					\label{eq:farfieldbound}
				\end{equation}
				Since the unit normal is given as radial component all around the farfield boundary, compliance with \ref{eq:farfieldbound} is achieved trough 
				\begin{equation*}
				 	\frac{\partial \mathbf{q}(x)}{\partial r} = 0 \qquad \forall x \in \partial \Omega_{far}.
				\end{equation*}
			 	The treatment of the cylinder boundary $\partial \Omega_{cyl}$ is more simple as the no-slip wall condition concludes
			 	\begin{equation*}
			 		\begin{split}
			 			\mathbf{q}(x) &= 0 \qquad \\
			 			\frac{\partial \mathbf{q}(x)}{\partial r} &= 0 \\
			 			\frac{\partial \mathbf{q}(x)}{\partial \phi} &= 0
			 		\end{split}
		 			\quad
		 			\begin{split}
		 				\forall x \in \partial \Omega_{cyl}
		 			\end{split}.
			 	\end{equation*}
				Given the centered POD decomposition of section \ref{sec:solpod}, the 
				Galerkin system can be constructed by computing the POD based coefficients, noted in equation \ref{eq:galerkincoeffs}, belonging to the ODE system in equation \ref{eq:galerkinsystem} with the inner product definition of equation \ref{eq:inprodmach}. The number of POD modes chosen as DOF for the reduced order model was four. \\
			\subsection{POD-ROM Solution}
				The resulting coefficients are not interpretable by themselves as they only present the projected relation of the governing equations. The system of ODE's is solved using LSODA, an adaptive ODE solver first proposed by \cite{lsoda1983} and implemented into Fortran by \cite{lsoda2010}. \\
				The temporal solution to the Galerkin system initially drifts towards an erroneous limit cycle depicted in figure \ref{fig:0.6unstablegalerkin}.
				\begin{figure}[h!]
					\includegraphics[width=\linewidth]{mach_0.6/rom/mach_0.6_unstabilized.png}
					\caption{Temporal solution to the Galerkin system obtained with LSODA ODE solver. The solution drifts towards an erroneous state solution. Activations are scaled with freestream velocity s.t. $a_s = \frac{a}{u_\infty}$.}
					\label{fig:0.6unstablegalerkin}
				\end{figure} 
				The convergence towards an faulty state is present for all three datasets at, although the behavior changes with increasing number of DOF. Choosing two or four modes, results in convergence to a stable limit cycle. Choosing six or more DOF to represent the system dynamics, results initially in the drift to a faulty limit cycle followed by a sporadic disturbance negating the periodic solution to a randomly actuated unstable system. \\
				In agreement with \cite{gloerfelt2008}, the incorrect convergence is expected and a stabilizing method needs to be employed for proper system progression. The deviation of system dynamics is due the lack of intrinsic dissipation, originating from the differences between the simulated equations and projected equations as well as differences in numerical treatment. The differences between the methods for obtaining the simulation data and the reduced order model are denoted in table \ref{tab:methoddiff}. 
				\begin{table}[h!]
					\centering
					\begin{tabular}{ l | m{4.9cm} | m{4.9cm} }
						\hline
						 & Full Order Model & Reduced Order Model \\
						\hline
						Governing Equation & Compressible NS & Isentropic NS \\
						Spatial Discretization & Finite Volume & FEM based Galerkin Projection \\
						Time Discretization & Euler Backward & Backward Differentiation \& Adam \\
						Derivative Scheme & Weighted Least Square Cell Average & Finite Difference \\
						\hline
					\end{tabular}
					\caption{General methodical differences of full and reduced order model leading to instability in ROM system propagation.}\label{tab:methoddiff}
				\end{table}
				The methods of both models differ in nearly every aspect, therefore the drift and deviation to the simulated behavior is expected and confirmed by the findings of \cite{gloerfelt2008}. \\ 
				Stabilization is achieved trough artificial viscosity from section  \ref{sec:stabilization} since it presents the simplest approach to achieve stability. The empirical tuning of artificial viscosity was found to be dependent on the number of DOF in the Galerkin system although there was no strict rule found. Stabilization with respect to suitable reconstruction quality was found in a small band of values for $\nu$ around some optimal $\nu_{opt}$. The tendency towards an erroneous limit cycle increases with the distance to $\nu_{opt}$ until the system becomes unstable. The ROM model is only considered at the optimal stabilizing viscosity with respect to reconstruction quality.\\
				By empirically determining the artificial viscosity, it was found that system dynamics become stable near the desired limit cycle for  combinations of mach and number of DOF depicted in table \ref{tab:stablecomb}. 
				\begin{table}[h!]
					\centering
					\begin{tabular}{ l | r | r | r | r | r }
						\hline
						\# of DOF & 2 & 4 & 6 & 8 & 10 \\
						\hline
						$\nu_{opt}$ at $Ma=0.01$ & 0.1550 & 0.1515 & 0.1515 & 0.151 & 0.1535 \\ 
						$\nu_{opt}$ at $Ma=0.1$ & 0.8625 & 0.7635 & 0.7390 & 0.7445 & 0.745 \\
						$\nu_{opt}$ at $Ma=0.6$ & 4.360 & 3.625 & 3.07 & 3.24 & 4.09 \\
						\hline
					\end{tabular}
					\caption{Artificial viscosity for desired limit cycle depending on number of DOF. }\label{tab:stablecomb}
				\end{table}				
				The stabilized ROM solution is depicted in figure \ref{fig:0.01stablegalerkin}, \ref{fig:0.1stablegalerkin} and \ref{fig:0.6stablegalerkin}.
				\begin{figure}[h!]
					\includegraphics[width=\linewidth]{mach_0.6/rom/mach_0.6_stabilized_av.png}
					\caption{Solution to the stabilized Galerkin system with artificial viscosity for $Ma=0.6$.}
					\label{fig:0.6stablegalerkin}
				\end{figure} 			
				The model needs about two shedding periods to reach the stable limit cycle. The settling time arises due to the differences in treatment between the models. The stable periodic solution matches the shedding frequency and the amplitudal limit, though the oscillation, apart from the main modes, show signs of coupled oscillation. This coupling is certainly due to the simplifications made in the derivation of the isentropic governing equations.\\
				The comparison of solutions to the Galerkin system and snapshot data obtained from simulation is depicted in \ref{fig:0.01recgalerkin}, \ref{fig:0.1recgalerkin} and \ref{fig:0.6recgalerkin}
				\begin{figure}[h!]
					\begin{subfigure}[b]{0.5\textwidth}
						\centering
						\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/rom/reconstruction/4/1.png}
						\caption{Snapshot 1}
					\end{subfigure}
					\begin{subfigure}[b]{0.5\textwidth}
						\centering
						\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/rom/reconstruction/4/6.png}
						\caption{Snapshot 2}
					\end{subfigure}
					\newline
					\begin{subfigure}[b]{0.5\textwidth}
						\centering
						\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/rom/reconstruction/4/11.png}
						\caption{Snapshot 3}
					\end{subfigure}
					\begin{subfigure}[b]{0.5\textwidth}
						\centering
						\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/rom/reconstruction/4/17.png}
						\caption{Snapshot 4}
					\end{subfigure}
					\caption{Snapshots of reconstruction based on the ROM solution for the $Ma = 0.6$ dataset with four POD modes and artifical viscosity stabilization.}
					\label{fig:0.6recgalerkin}
				\end{figure}
				The reconstruction is clearly showing differences to the optimal model, although the solution matches closely in frequency and the amplitudal limit. \\
				The differences to the simulation data arise from two main causes, truncation error and methodical difference. The snapshot POD modes fail to capture the flow tendencies of the isentropic problem fully, therefore producing mode coupling, represented in the coupled oscillations of DOF. Secondly the truncation error shifts modal energy into latter DOF. This can clearly be shown by using $6$ or $8$ POD modes for ROM construction. The visualization of flow reconstruction from the eight POD solution to the Galerkin system are depicted in \ref{fig:0.6recgalerkin_add}.
				\begin{figure}[h!]
					\begin{subfigure}[b]{0.5\textwidth}
						\centering
						\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/rom/reconstruction/8/1.png}
						\caption{Snapshot 1}
					\end{subfigure}
					\begin{subfigure}[b]{0.5\textwidth}
						\centering
						\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/rom/reconstruction/8/6.png}
						\caption{Snapshot 2}
					\end{subfigure}
					\newline
					\begin{subfigure}[b]{0.5\textwidth}
						\centering
						\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/rom/reconstruction/8/11.png}
						\caption{Snapshot 3}
					\end{subfigure}
					\begin{subfigure}[b]{0.5\textwidth}
						\centering
						\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.6/rom/reconstruction/8/17.png}
						\caption{Snapshot 4}
					\end{subfigure}
					\caption{Snapshots of reconstruction based on the ROM solution for the $Ma = 0.6$ dataset with eight POD modes and artifical viscosity stabilization.}
					\label{fig:0.6recgalerkin_add}
				\end{figure}
				Clearly the reconstruction quality is visually improved. Since the modal energy of the reconstruction is captured into more modes, the tendency of the system to distribute unrepresented energy onto latter, less impactful modes, becomes less of a problem regarding the reconstruction error. This is known as truncation error as the system is limited to a low number of DOF to capture the dynamics imposed by the governing equations. 
				
				
		\section{Control Application}
			
		
	\chapter{Conclusion}
			
\appendix
	\chapter{POD}
	\begin{figure}[h!]
		\begin{subfigure}{\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 8cm 1.5cm,clip]{mach_0.01/mach_0.01_POD_q_avg.png}
			\caption{$Mach \; 0.01$}
		\end{subfigure}
		\newline
		\begin{subfigure}{\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 8cm 1.5cm,clip]{mach_0.1/mach_0.1_POD_q_avg.png}
			\caption{$Mach \; 0.1$}
		\end{subfigure}
		\caption{Normalized average flow field for the flow around a circular cylinder in the vortex shedding region for different mach flows. Note the time averaged flows are mostly similar, while the vortex shedding region differs due to the different scale of vortexes corresponding to the mach number.}
		\label{fig:averageFlow}
	\end{figure}

	\begin{figure}[h!]
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.01/pod_modes/mach_0.01_POD_0.png}
			\caption{Eigenmode 0}
		\end{subfigure}
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.01/pod_modes/mach_0.01_POD_1.png}
			\caption{Eigenmode 1}
		\end{subfigure}
		\newline
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.01/pod_modes/mach_0.01_POD_2.png}
			\caption{Eigenmode 2}
		\end{subfigure}
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.01/pod_modes/mach_0.01_POD_3.png}
			\caption{Eigenmode 3}
		\end{subfigure}
		\newline
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.01/pod_modes/mach_0.01_POD_4.png}
			\caption{Eigenmode 4}
		\end{subfigure}
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.01/pod_modes/mach_0.01_POD_5.png}
			\caption{Eigenmode 5}
		\end{subfigure}
		\newline
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.01/pod_modes/mach_0.01_POD_6.png}
			\caption{Eigenmode 6}
		\end{subfigure}
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.01/pod_modes/mach_0.01_POD_7.png}
			\caption{Eigenmode 7}
		\end{subfigure}
		\caption{Leading eight POD basis functions as velocity in x-direction for mach $0.01$ flow with subtracted mean.}
		\label{fig:podma0.01}
	\end{figure} 
	\begin{figure}[h!]
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.1/pod_modes/mach_0.1_POD_0.png}
			\caption{Eigenmode 0}
		\end{subfigure}
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.1/pod_modes/mach_0.1_POD_1.png}
			\caption{Eigenmode 1}
		\end{subfigure}
		\newline
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.1/pod_modes/mach_0.1_POD_2.png}
			\caption{Eigenmode 2}
		\end{subfigure}
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.1/pod_modes/mach_0.1_POD_3.png}
			\caption{Eigenmode 3}
		\end{subfigure}
		\newline
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.1/pod_modes/mach_0.1_POD_4.png}
			\caption{Eigenmode 4}
		\end{subfigure}
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.1/pod_modes/mach_0.1_POD_5.png}
			\caption{Eigenmode 5}
		\end{subfigure}
		\newline
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.1/pod_modes/mach_0.1_POD_6.png}
			\caption{Eigenmode 6}
		\end{subfigure}
		\begin{subfigure}{0.5\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=5cm 1.5cm 12cm 1.5cm,clip]{mach_0.1/pod_modes/mach_0.1_POD_7.png}
			\caption{Eigenmode 7}
		\end{subfigure}
		\caption{Leading eight POD basis functions as velocity in x-direction for mach $0.1$ flow with subtracted mean.}
		\label{fig:podma0.1}
	\end{figure} 			
	\begin{figure}[h!]
		\begin{subfigure}{0.48\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=0.5 0.5 1.5cm 1.5cm,clip]{mach_0.01/POD_Eigenvalues_0.01.png}
			\caption{Eigenvalues for POD decomposition for dataset with mach $0.01$}
		\end{subfigure}
		\quad
		\begin{subfigure}{0.48\textwidth}
			\centering
			\includegraphics[width=\linewidth,trim=0.5 0.5 1.5cm 1.5cm,clip]{mach_0.1/POD_Eigenvalues_0.1.png}
			\caption{Eigenvalues for POD decomposition for dataset with mach $0.1$}
		\end{subfigure}
		\caption{Semi-logarithmic y-axis plots displaying the eigenvalues that correspond to the POD modes ordered by magnitude.}
		\label{fig:podeig}
	\end{figure}
		
	\chapter{Optimal Model}

		\begin{figure}[h!]
			\begin{subfigure}{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth]{mach_0.01/activation/mach_0.01_pod_activ_eig_0_1.png}
				\caption{Eigenmode 0 and 1}
			\end{subfigure}
			\begin{subfigure}{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth]{mach_0.01/activation/mach_0.01_pod_activ_eig_2_3.png}
				\caption{Eigenmode 2 and 3}
			\end{subfigure}
			\newline
			\begin{subfigure}{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth]{mach_0.01/activation/mach_0.01_pod_activ_eig_4_5.png}
				\caption{Eigenmode 4 and 5}
			\end{subfigure}
			\begin{subfigure}{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth]{mach_0.01/activation/mach_0.01_pod_activ_eig_6_7.png}
				\caption{Eigenmode 6 and 7}
			\end{subfigure}
			\caption{Optimal activations for the leading eight eigenmodes grouped into complementary pairs for the dataset with $Ma=0.01$.}
			\label{fig:podactiv0.01}
		\end{figure}
		\begin{figure}[h!]
			\begin{subfigure}{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth]{mach_0.1/activation/mach_0.1_pod_activ_eig_0_1.png}
				\caption{Eigenmode 0 and 1}
			\end{subfigure}
			\begin{subfigure}{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth]{mach_0.1/activation/mach_0.1_pod_activ_eig_2_3.png}
				\caption{Eigenmode 2 and 3}
			\end{subfigure}
			\newline
			\begin{subfigure}{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth]{mach_0.1/activation/mach_0.1_pod_activ_eig_4_5.png}
				\caption{Eigenmode 4 and 5}
			\end{subfigure}
			\begin{subfigure}{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth]{mach_0.1/activation/mach_0.1_pod_activ_eig_6_7.png}
				\caption{Eigenmode 6 and 7}
			\end{subfigure}
			\caption{Optimal activations for the leading eight eigenmodes grouped into complementary pairs for the dataset with $Ma=0.1$.}
			\label{fig:podactiv0.1}
		\end{figure}	
		\begin{figure}[h!]
			\begin{subfigure}{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=0.5 0.5 1.5cm 1.5cm,clip]{mach_0.01/reconstruction/mach_0.01_rec_error.png}
				\caption{Reconstruction error for dataset with $Ma=0.01$}
			\end{subfigure}
			\quad
			\begin{subfigure}{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=0.5 0.5 1.5cm 1.5cm,clip]{mach_0.1/reconstruction/mach_0.1_rec_error.png}
				\caption{Reconstruction error for dataset with $Ma=0.1$}
			\end{subfigure}
			\caption{Semi-logarithmic y-axis plots displaying the reconstruction error, measured as mean squared error, over the number of pod modes chosen for reconstruction of the flow field.}
			\label{fig:podrecerror}
		\end{figure}
		\begin{figure}[h!]
			\hspace{3cm} Snapshot $0$ \hfill Snapshot $50$ \hspace{2.2cm}
			\newline
			\begin{turn}{90}
				\hspace{0.1cm}
				Ground Truth
			\end{turn}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.01/reconstruction/mach_0.01_gt_snap_0.png}
			\end{subfigure}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.01/reconstruction/mach_0.01_gt_snap_50.png}
			\end{subfigure}
			\newline
			\begin{turn}{90}
				\hspace{0.6cm}
				2 Modes
			\end{turn}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.01/reconstruction/mach_0.01_rec_2_modes_snap_0.png}
			\end{subfigure}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.01/reconstruction/mach_0.01_rec_2_modes_snap_50.png}
			\end{subfigure}
			\newline
			\begin{turn}{90}
				\hspace{0.6cm}
				4 Modes
			\end{turn}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.01/reconstruction/mach_0.01_rec_4_modes_snap_0.png}
			\end{subfigure}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.01/reconstruction/mach_0.01_rec_4_modes_snap_50.png}
			\end{subfigure}
			\newline
			\begin{turn}{90}
				\hspace{0.6cm}
				6 Modes
			\end{turn}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.01/reconstruction/mach_0.01_rec_6_modes_snap_0.png}
			\end{subfigure}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.01/reconstruction/mach_0.01_rec_6_modes_snap_50.png}
			\end{subfigure}
			\caption{Snapshots at two time steps in the top with snapshot reconstruction based on two, four and six modes below for the dataset at $Ma=0.01$.}
			\label{fig:podrec0.01}
		\end{figure}
		\begin{figure}[h!]
			\hspace{3cm} Snapshot $0$ \hfill Snapshot $50$ \hspace{2.2cm}
			\newline
			\begin{turn}{90}
				\hspace{0.1cm}
				Ground Truth
			\end{turn}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.1/reconstruction/mach_0.1_gt_snap_0.png}
			\end{subfigure}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.1/reconstruction/mach_0.1_gt_snap_50.png}
			\end{subfigure}
			\newline
			\begin{turn}{90}
				\hspace{0.6cm}
				2 Modes
			\end{turn}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.1/reconstruction/mach_0.1_rec_2_modes_snap_0.png}
			\end{subfigure}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.1/reconstruction/mach_0.1_rec_2_modes_snap_50.png}
			\end{subfigure}
			\newline
			\begin{turn}{90}
				\hspace{0.6cm}
				4 Modes
			\end{turn}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.1/reconstruction/mach_0.1_rec_4_modes_snap_0.png}
			\end{subfigure}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.1/reconstruction/mach_0.1_rec_4_modes_snap_50.png}
			\end{subfigure}
			\newline
			\begin{turn}{90}
				\hspace{0.6cm}
				6 Modes
			\end{turn}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.1/reconstruction/mach_0.1_rec_6_modes_snap_0.png}
			\end{subfigure}
			\begin{subfigure}[b]{0.48\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.1/reconstruction/mach_0.1_rec_6_modes_snap_50.png}
			\end{subfigure}
			\caption{Snapshots at two time steps in the top with snapshot reconstruction based on two, four and six modes below for the dataset at $Ma=0.1$.}
			\label{fig:podrec0.1}
		\end{figure}
	
	\chapter{ROM}
		\begin{figure}[h!]
			\includegraphics[width=\linewidth]{mach_0.01/rom/mach_0.01_stabilized_av.png}
			\caption{Solution to the stabilized Galerkin system with artificial viscosity for $Ma=0.01$.}
			\label{fig:0.01stablegalerkin}
		\end{figure} 
		\begin{figure}[h!]
			\includegraphics[width=\linewidth]{mach_0.1/rom/mach_0.1_stabilized_av.png}
			\caption{Solution to the stabilized Galerkin system with artificial viscosity for $Ma=0.1$.}
			\label{fig:0.1stablegalerkin}
		\end{figure} 
		\begin{figure}[h!]
			\begin{subfigure}[b]{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.01/rom/reconstruction/4/1.png}
				\caption{Snapshot 1}
			\end{subfigure}
			\begin{subfigure}[b]{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.01/rom/reconstruction/4/6.png}
				\caption{Snapshot 2}
			\end{subfigure}
			\newline
			\begin{subfigure}[b]{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.01/rom/reconstruction/4/11.png}
				\caption{Snapshot 3}
			\end{subfigure}
			\begin{subfigure}[b]{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.01/rom/reconstruction/4/17.png}
				\caption{Snapshot 4}
			\end{subfigure}
			\caption{Snapshots of reconstruction based on the ROM solution for the $Ma = 0.01$ dataset with four POD modes and artifical viscosity stabilization.}
			\label{fig:0.01recgalerkin}
		\end{figure}
		\begin{figure}[h!]
			\begin{subfigure}[b]{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.1/rom/reconstruction/4/1.png}
				\caption{Snapshot 1}
			\end{subfigure}
			\begin{subfigure}[b]{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.1/rom/reconstruction/4/6.png}
				\caption{Snapshot 2}
			\end{subfigure}
			\newline
			\begin{subfigure}[b]{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.1/rom/reconstruction/4/11.png}
				\caption{Snapshot 3}
			\end{subfigure}
			\begin{subfigure}[b]{0.5\textwidth}
				\centering
				\includegraphics[width=\linewidth,trim=5cm 1.5cm 11cm 1.5cm,clip]{mach_0.1/rom/reconstruction/4/17.png}
				\caption{Snapshot 4}
			\end{subfigure}
			\caption{Snapshots of reconstruction based on the ROM solution for the $Ma = 0.1$ dataset with four POD modes and artifical viscosity stabilization.}
			\label{fig:0.1recgalerkin}
		\end{figure}
		
			
%look at first bib entry
\nocite{*}
\bibliography{bibliography}
\bibliographystyle{plain}
\end{document}